(*---------------------------------------------------------------------------*\
 *  Copyright (c) 2003 - 2004 by Dirk Muysers.
 *  For details see file "copying.txt"
 *
 *  MODULE:    Unicode.m3
 *  PURPOSE:   Unicode character set
 *  HISTORY:
 *    DATE          PROGRAMMER       DESCRIPTION
 *    30-Nov-2003   Dirk Muysers     Initial creation
 *
 *  NOTE:
 *    The data tables in this module are based on the file 
 *    "UnicodeData-3.2.0.txt".
 *
 *----------------------------------------------------------------------------
 *  $Id$
\*---------------------------------------------------------------------------*)
UNSAFE MODULE Unicode;

(*---------------------------------------------------------------------------*}
 * DESCRIPTION:
 * 
 * This implementation admittedly uses a brute force approach.  
 *
 * Normally, UNICODE character properties should be provided by the operating 
 * system, which is not the case for the majority of the existing Win32 
 * platforms.  This implementation, while being a performance hog, has the
 * advantage of having a minimal memory footprint.  Most operating system 
 * implementations that offer good performance require at least 2 MB of 
 * memory for hosting the corresponding property tables. 
 *
 * Reference: Optimal Unicode 3.x Character Attributes and Access Methods 
 * <http://developers.sun.com/dev/gadc/technicalpublications/presentations/
 *  iuc19-optimalunicode.pdf>
 *
{*---------------------------------------------------------------------------*)

(*===========================================================================*}
 * TYPES
{*===========================================================================*)

TYPE 
  Ord = BITS 16 FOR [0..16_FFFF];
  Ptr = UNTRACED REF Ord;

(*===========================================================================*}
 * DATA
{*===========================================================================*)

VAR

(*---------------------------------------------------------------------------*}
 * Spaces
{*---------------------------------------------------------------------------*)

  space2 := ARRAY [0..13] OF Ord {
    16_0009, 16_000D, (* tab, form feed, newline and carriage return *)
    16_0020, 16_0020, (* space *)
    16_00a0, 16_00A0, (* non-break space *)
    16_2000, 16_200B, (* â€€ - â€‹ *)
    16_2028, 16_2029, (* â€¨ - â€© *)
    16_3000, 16_3000, (* ã€€ *)
    16_FEFF, 16_FEFF  (* byte order mark *)
    };

(*---------------------------------------------------------------------------*}
 * Letter ranges (covers only those ranges that are not in lower or upper)
{*---------------------------------------------------------------------------*)

  alpha2 := ARRAY [0..303] OF Ord {
    16_00D8,	16_00F6,	(* Ã˜ - Ã¶ *)
    16_00F8,	16_01F5,	(* Ã¸ - Çµ *)
    16_0250,	16_02A8,	(* É - Ê¨ *)
    16_038E,	16_03A1,	(* ÎŽ - Î¡ *)
    16_03A3,	16_03CE,	(* Î£ - ÏŽ *)
    16_03D0,	16_03D6,	(* Ï - Ï– *)
    16_03E2,	16_03F3,	(* Ï¢ - Ï³ *)
    16_0490,	16_04C4,	(* Ò - Ó„ *)
    16_0561,	16_0587,	(* Õ¡ - Ö‡ *)
    16_05D0,	16_05EA,	(* × - ×ª *)
    16_05F0,	16_05F2,	(* ×° - ×² *)
    16_0621,	16_063A,	(* Ø¡ - Øº *)
    16_0640,	16_064A,	(* Ù€ - ÙŠ *)
    16_0671,	16_06B7,	(* Ù± - Ú· *)
    16_06BA,	16_06BE,	(* Úº - Ú¾ *)
    16_06C0,	16_06CE,	(* Û€ - ÛŽ *)
    16_06D0,	16_06D3,	(* Û - Û“ *)
    16_0905,	16_0939,	(* à¤… - à¤¹ *)
    16_0958,	16_0961,	(* à¥˜ - à¥¡ *)
    16_0985,	16_098C,	(* à¦… - à¦Œ *)
    16_098F,	16_0990,	(* à¦ - à¦ *)
    16_0993,	16_09A8,	(* à¦“ - à¦¨ *)
    16_09AA,	16_09B0,	(* à¦ª - à¦° *)
    16_09B6,	16_09B9,	(* à¦¶ - à¦¹ *)
    16_09DC,	16_09DD,	(* à§œ - à§ *)
    16_09DF,	16_09E1,	(* à§Ÿ - à§¡ *)
    16_09F0,	16_09F1,	(* à§° - à§± *)
    16_0A05,	16_0A0A,	(* à¨… - à¨Š *)
    16_0A0F,	16_0A10,	(* à¨ - à¨ *)
    16_0A13,	16_0A28,	(* à¨“ - à¨¨ *)
    16_0A2A,	16_0A30,	(* à¨ª - à¨° *)
    16_0A32,	16_0A33,	(* à¨² - à¨³ *)
    16_0A35,	16_0A36,	(* à¨µ - à¨¶ *)
    16_0A38,	16_0A39,	(* à¨¸ - à¨¹ *)
    16_0A59,	16_0A5C,	(* à©™ - à©œ *)
    16_0A85,	16_0A8B,	(* àª… - àª‹ *)
    16_0A8F,	16_0A91,	(* àª - àª‘ *)
    16_0A93,	16_0AA8,	(* àª“ - àª¨ *)
    16_0AAA,	16_0AB0,	(* àªª - àª° *)
    16_0AB2,	16_0AB3,	(* àª² - àª³ *)
    16_0AB5,	16_0AB9,	(* àªµ - àª¹ *)
    16_0B05,	16_0B0C,	(* à¬… - à¬Œ *)
    16_0B0F,	16_0B10,	(* à¬ - à¬ *)
    16_0B13,	16_0B28,	(* à¬“ - à¬¨ *)
    16_0B2A,	16_0B30,	(* à¬ª - à¬° *)
    16_0B32,	16_0B33,	(* à¬² - à¬³ *)
    16_0B36,	16_0B39,	(* à¬¶ - à¬¹ *)
    16_0B5C,	16_0B5D,	(* à­œ - à­ *)
    16_0B5F,	16_0B61,	(* à­Ÿ - à­¡ *)
    16_0B85,	16_0B8A,	(* à®… - à®Š *)
    16_0B8E,	16_0B90,	(* à®Ž - à® *)
    16_0B92,	16_0B95,	(* à®’ - à®• *)
    16_0B99,	16_0B9A,	(* à®™ - à®š *)
    16_0B9E,	16_0B9F,	(* à®ž - à®Ÿ *)
    16_0BA3,	16_0BA4,	(* à®£ - à®¤ *)
    16_0BA8,	16_0BAA,	(* à®¨ - à®ª *)
    16_0BAE,	16_0BB5,	(* à®® - à®µ *)
    16_0BB7,	16_0BB9,	(* à®· - à®¹ *)
    16_0C05,	16_0C0C,	(* à°… - à°Œ *)
    16_0C0E,	16_0C10,	(* à°Ž - à° *)
    16_0C12,	16_0C28,	(* à°’ - à°¨ *)
    16_0C2A,	16_0C33,	(* à°ª - à°³ *)
    16_0C35,	16_0C39,	(* à°µ - à°¹ *)
    16_0C60,	16_0C61,	(* à±  - à±¡ *)
    16_0C85,	16_0C8C,	(* à²… - à²Œ *)
    16_0C8E,	16_0C90,	(* à²Ž - à² *)
    16_0C92,	16_0CA8,	(* à²’ - à²¨ *)
    16_0CAA,	16_0CB3,	(* à²ª - à²³ *)
    16_0CB5,	16_0CB9,	(* à²µ - à²¹ *)
    16_0CE0,	16_0CE1,	(* à³  - à³¡ *)
    16_0D05,	16_0D0C,	(* à´… - à´Œ *)
    16_0D0E,	16_0D10,	(* à´Ž - à´ *)
    16_0D12,	16_0D28,	(* à´’ - à´¨ *)
    16_0D2A,	16_0D39,	(* à´ª - à´¹ *)
    16_0D60,	16_0D61,	(* àµ  - àµ¡ *)
    16_0E01,	16_0E30,	(* à¸ - à¸° *)
    16_0E32,	16_0E33,	(* à¸² - à¸³ *)
    16_0E40,	16_0E46,	(* à¹€ - à¹† *)
    16_0E5A,	16_0E5B,	(* à¹š - à¹› *)
    16_0E81,	16_0E82,	(* àº - àº‚ *)
    16_0E87,	16_0E88,	(* àº‡ - àºˆ *)
    16_0E94,	16_0E97,	(* àº” - àº— *)
    16_0E99,	16_0E9F,	(* àº™ - àºŸ *)
    16_0EA1,	16_0EA3,	(* àº¡ - àº£ *)
    16_0EAA,	16_0EAB,	(* àºª - àº« *)
    16_0EAD,	16_0EAE,	(* àº­ - àº® *)
    16_0EB2,	16_0EB3,	(* àº² - àº³ *)
    16_0EC0,	16_0EC4,	(* à»€ - à»„ *)
    16_0EDC,	16_0EDD,	(* à»œ - à» *)
    16_0F18,	16_0F19,	(* à¼˜ - à¼™ *)
    16_0F40,	16_0F47,	(* à½€ - à½‡ *)
    16_0F49,	16_0F69,	(* à½‰ - à½© *)
    16_10D0,	16_10F6,	(* áƒ - áƒ¶ *)
    16_1100,	16_1159,	(* á„€ - á…™ *)
    16_115F,	16_11A2,	(* á…Ÿ - á†¢ *)
    16_11A8,	16_11F9,	(* á†¨ - á‡¹ *)
    16_1E00,	16_1E9B,	(* á¸€ - áº› *)
    16_1F50,	16_1F57,	(* á½ - á½— *)
    16_1F80,	16_1FB4,	(* á¾€ - á¾´ *)
    16_1FB6,	16_1FBC,	(* á¾¶ - á¾¼ *)
    16_1FC2,	16_1FC4,	(* á¿‚ - á¿„ *)
    16_1FC6,	16_1FCC,	(* á¿† - á¿Œ *)
    16_1FD0,	16_1FD3,	(* á¿ - á¿“ *)
    16_1FD6,	16_1FDB,	(* á¿– - á¿› *)
    16_1FE0,	16_1FEC,	(* á¿  - á¿¬ *)
    16_1FF2,	16_1FF4,	(* á¿² - á¿´ *)
    16_1FF6,	16_1FFC,	(* á¿¶ - á¿¼ *)
    16_210A,	16_2113,	(* â„Š - â„“ *)
    16_2115,	16_211D,	(* â„• - â„ *)
    16_2120,	16_2122,	(* â„  - â„¢ *)
    16_212A,	16_2131,	(* â„ª - â„± *)
    16_2133,	16_2138,	(* â„³ - â„¸ *)
    16_3041,	16_3094,	(* ã - ã‚” *)
    16_30A1,	16_30FA,	(* ã‚¡ - ãƒº *)
    16_3105,	16_312C,	(* ã„… - ã„¬ *)
    16_3131,	16_318E,	(* ã„± - ã†Ž *)
    16_3192,	16_319F,	(* ã†’ - ã†Ÿ *)
    16_3260,	16_327B,	(* ã‰  - ã‰» *)
    16_328A,	16_32B0,	(* ãŠŠ - ãŠ° *)
    16_32D0,	16_32FE,	(* ã‹ - ã‹¾ *)
    16_3300,	16_3357,	(* ãŒ€ - ã— *)
    16_3371,	16_3376,	(* ã± - ã¶ *)
    16_337B,	16_3394,	(* ã» - ãŽ” *)
    16_3399,	16_339E,	(* ãŽ™ - ãŽž *)
    16_33A9,	16_33AD,	(* ãŽ© - ãŽ­ *)
    16_33B0,	16_33C1,	(* ãŽ° - ã *)
    16_33C3,	16_33C5,	(* ãƒ - ã… *)
    16_33C7,	16_33D7,	(* ã‡ - ã— *)
    16_33D9,	16_33DD,	(* ã™ - ã *)
    16_4E00,	16_9FFF,	(* ä¸€ - é¿¿ *)
    16_AC00,	16_D7A3,	(* ê°€ - íž£ *)
    16_F900,	16_FB06,	(* ï¤€ - ï¬† *)
    16_FB13,	16_FB17,	(* ï¬“ - ï¬— *)
    16_FB1F,	16_FB28,	(* ï¬Ÿ - ï¬¨ *)
    16_FB2A,	16_FB36,	(* ï¬ª - ï¬¶ *)
    16_FB38,	16_FB3C,	(* ï¬¸ - ï¬¼ *)
    16_FB40,	16_FB41,	(* ï­€ - ï­ *)
    16_FB43,	16_FB44,	(* ï­ƒ - ï­„ *)
    16_FB46,	16_FBB1,	(* ï­† - ï®± *)
    16_FBD3,	16_FD3D,	(* ï¯“ - ï´½ *)
    16_FD50,	16_FD8F,	(* ïµ - ï¶ *)
    16_FD92,	16_FDC7,	(* ï¶’ - ï·‡ *)
    16_FDF0,	16_FDF9,	(* ï·° - ï·¹ *)
    16_FE70,	16_FE72,	(* ï¹° - ï¹² *)
    16_FE76,	16_FEFC,	(* ï¹¶ - ï»¼ *)
    16_FF66,	16_FF6F,	(* ï½¦ - ï½¯ *)
    16_FF71,	16_FF9D,	(* ï½± - ï¾ *)
    16_FFA0,	16_FFBE,	(* ï¾  - ï¾¾ *)
    16_FFC2,	16_FFC7,	(* ï¿‚ - ï¿‡ *)
    16_FFCA,	16_FFCF,	(* ï¿Š - ï¿ *)
    16_FFD2,	16_FFD7,	(* ï¿’ - ï¿— *)
    16_FFDA,    16_FFDC         (* ï¿š - ï¿œ *)
    };

(*---------------------------------------------------------------------------*}
 * Letter singletons (only covers those letters that are not in upper/lower)
{*---------------------------------------------------------------------------*)

  alpha1 := ARRAY [0..31] OF Ord {
    16_00AA,	(* Âª *)
    16_00B5,	(* Âµ *)
    16_00BA,	(* Âº *)
    16_03DA,	(* Ïš *)
    16_03DC,	(* Ïœ *)
    16_03DE,	(* Ïž *)
    16_03E0,	(* Ï  *)
    16_06D5,	(* Û• *)
    16_09B2,	(* à¦² *)
    16_0A5E,	(* à©ž *)
    16_0A8D,	(* àª *)
    16_0AE0,	(* à«  *)
    16_0B9C,	(* à®œ *)
    16_0CDE,	(* à³ž *)
    16_0E4F,	(* à¹ *)
    16_0E84,	(* àº„ *)
    16_0E8A,	(* àºŠ *)
    16_0E8D,	(* àº *)
    16_0EA5,	(* àº¥ *)
    16_0EA7,	(* àº§ *)
    16_0EB0,	(* àº° *)
    16_0EBD,	(* àº½ *)
    16_1FBE,	(* á¾¾ *)
    16_207F,	(* â¿ *)
    16_20A8,	(* â‚¨ *)
    16_2102,	(* â„‚ *)
    16_2107,	(* â„‡ *)
    16_2124,	(* â„¤ *)
    16_2126,	(* â„¦ *)
    16_2128,	(* â„¨ *)
    16_FB3E,	(* ï¬¾ *)
    16_FE74	(* ï¹´ *)
    };

(*---------------------------------------------------------------------------*}
 * Decimal digit ranges
{*---------------------------------------------------------------------------*)

  digit2 := ARRAY [0..41] OF Ord {
    16_0030, 16_0039, (* Digit *)
    16_0660, 16_0669, (* Arabic Indic *)
    16_06F0, 16_06F9, (* Extended Arabic Indic *)
    16_0966, 16_096F, (* Devanagari *)
    16_09E6, 16_09EF, (* Bengali *)
    16_0A66, 16_0A6F, (* Gurmukhi *)
    16_0AE6, 16_0AEF, (* Gujarati *)
    16_0B66, 16_0B6F, (* Oriya *)
    16_0BE7, 16_0BEF, (* Tamil [1..9] :-( *)
    16_0C66, 16_0C6F, (* Telugu *)
    16_0CE6, 16_0CEF, (* Kannara *)
    16_0D66, 16_0D6F, (* Malyalam *)
    16_0E50, 16_0E59, (* Thai *)
    16_0ED0, 16_0ED9, (* Lao *)
    16_0F20, 16_0F29, (* Tibetan *)
    16_1040, 16_1049, (* Burmese *)
    16_1369, 16_1371, (* Ethiopian [1..9] :-( *)
    16_17E0, 16_17E9, (* Khmer *)
    16_1810, 16_1819, (* Gurmukhi *)
    16_0A66, 16_0A6F, (* Mongolian *)
    16_FF10, 16_FF19  (* Fullwidth digit *)
    };

(*---------------------------------------------------------------------------*}
 * Upper-case ranges  (3rd column is conversion excess 500)
{*---------------------------------------------------------------------------*)

  tolower3 := ARRAY [0..107] OF Ord {
    16_0041, 16_005A, 532, (* A-Z a-z *)
    16_00C0, 16_00D6, 532, (* Ã€-Ã– Ã -Ã¶ *)
    16_00D8, 16_00DE, 532, (* Ã˜-Ãž Ã¸-Ã¾ *)
    16_0189, 16_018A, 705, (* Æ‰-ÆŠ É–-É— *)
    16_018E, 16_018F, 702, (* ÆŽ-Æ É˜-É™ *)
    16_01B1, 16_01B2, 717, (* Æ±-Æ² ÊŠ-Ê‹ *)
    16_0388, 16_038A, 537, (* Îˆ-ÎŠ Î­-Î¯ *)
    16_038E, 16_038F, 563, (* ÎŽ-Î Ï-ÏŽ *)
    16_0391, 16_03A1, 532, (* Î‘-Î¡ Î±-Ï *)
    16_03A3, 16_03AB, 532, (* Î£-Î« Ïƒ-Ï‹ *)
    16_0401, 16_040C, 580, (* Ð-ÐŒ Ñ‘-Ñœ *)
    16_040E, 16_040F, 580, (* ÐŽ-Ð Ñž-ÑŸ *)
    16_0410, 16_042F, 532, (* Ð-Ð¯ Ð°-Ñ *)
    16_0531, 16_0556, 548, (* Ô±-Õ– Õ¡-Ö† *)
    16_10A0, 16_10C5, 548, (* á‚ -áƒ… áƒ-áƒµ *)
    16_1F08, 16_1F0F, 492, (* á¼ˆ-á¼ á¼€-á¼‡ *)
    16_1F18, 16_1F1D, 492, (* á¼˜-á¼ á¼-á¼• *)
    16_1F28, 16_1F2F, 492, (* á¼¨-á¼¯ á¼ -á¼§ *)
    16_1F38, 16_1F3F, 492, (* á¼¸-á¼¿ á¼°-á¼· *)
    16_1F48, 16_1F4D, 492, (* á½ˆ-á½ á½€-á½… *)
    16_1F68, 16_1F6F, 492, (* á½¨-á½¯ á½ -á½§ *)
    16_1F88, 16_1F8F, 492, (* Á¾ˆ-á¾ á¾€-á¾‡ *)
    16_1F98, 16_1F9F, 492, (* á¾˜-á¾Ÿ á¾-á¾— *)
    16_1FA8, 16_1FAF, 492, (* á¾¨-á¾¯ á¾ -á¾§ *)
    16_1FB8, 16_1FB9, 492, (* á¾¸-á¾¹ á¾°-á¾± *)
    16_1FBA, 16_1FBB, 426, (* á¾º-á¾» á½°-á½± *)
    16_1FC8, 16_1FCB, 414, (* á¿ˆ-á¿‹ á½²-á½µ *)
    16_1FD8, 16_1FD9, 492, (* á¿˜-á¿™ á¿-á¿‘ *)
    16_1FDA, 16_1FDB, 400, (* á¿š-á¿› á½¶-á½· *)
    16_1FE8, 16_1FE9, 492, (* á¿¨-á¿© á¿ -á¿¡ *)
    16_1FEA, 16_1FEB, 388, (* á¿ª-á¿« á½º-á½» *)
    16_1FF8, 16_1FF9, 372, (* á¿¸-á¿¹ á½¸-á½¹ *)
    16_1FFA, 16_1FFB, 374, (* á¿º-á¿» á½¼-á½½ *)
    16_2160, 16_216F, 516, (* â… -â…¯ â…°-â…¿ *)
    16_24B6, 16_24CF, 526, (* â’¶-â“ â“-â“© *)
    16_FF21, 16_FF3A, 532  (* ï¼¡-ï¼º ï½-ï½š *)
    };

(*---------------------------------------------------------------------------*}
 * Upper-case Singletons  (2nd column is conversion excess 500
{*---------------------------------------------------------------------------*)
  
  tolower2 := ARRAY [0..665] OF Ord {
    16_0100, 501,	(* Ä€ Ä *)
    16_0102, 501,	(* Ä‚ Äƒ *)
    16_0104, 501,	(* Ä„ Ä… *)
    16_0106, 501,	(* Ä† Ä‡ *)
    16_0108, 501,	(* Äˆ Ä‰ *)
    16_010A, 501,	(* ÄŠ Ä‹ *)
    16_010C, 501,	(* ÄŒ Ä *)
    16_010E, 501,	(* ÄŽ Ä *)
    16_0110, 501,	(* Ä Ä‘ *)
    16_0112, 501,	(* Ä’ Ä“ *)
    16_0114, 501,	(* Ä” Ä• *)
    16_0116, 501,	(* Ä– Ä— *)
    16_0118, 501,	(* Ä˜ Ä™ *)
    16_011A, 501,	(* Äš Ä› *)
    16_011C, 501,	(* Äœ Ä *)
    16_011E, 501,	(* Äž ÄŸ *)
    16_0120, 501,	(* Ä  Ä¡ *)
    16_0122, 501,	(* Ä¢ Ä£ *)
    16_0124, 501,	(* Ä¤ Ä¥ *)
    16_0126, 501,	(* Ä¦ Ä§ *)
    16_0128, 501,	(* Ä¨ Ä© *)
    16_012A, 501,	(* Äª Ä« *)
    16_012C, 501,	(* Ä¬ Ä­ *)
    16_012E, 501,	(* Ä® Ä¯ *)
    16_0130, 301,	(* Ä° i *)
    16_0132, 501,	(* Ä² Ä³ *)
    16_0134, 501,	(* Ä´ Äµ *)
    16_0136, 501,	(* Ä¶ Ä· *)
    16_0139, 501,	(* Ä¹ Äº *)
    16_013B, 501,	(* Ä» Ä¼ *)
    16_013D, 501,	(* Ä½ Ä¾ *)
    16_013F, 501,	(* Ä¿ Å€ *)
    16_0141, 501,	(* Å Å‚ *)
    16_0143, 501,	(* Åƒ Å„ *)
    16_0145, 501,	(* Å… Å† *)
    16_0147, 501,	(* Å‡ Åˆ *)
    16_014A, 501,	(* ÅŠ Å‹ *)
    16_014C, 501,	(* ÅŒ Å *)
    16_014E, 501,	(* ÅŽ Å *)
    16_0150, 501,	(* Å Å‘ *)
    16_0152, 501,	(* Å’ Å“ *)
    16_0154, 501,	(* Å” Å• *)
    16_0156, 501,	(* Å– Å— *)
    16_0158, 501,	(* Å˜ Å™ *)
    16_015A, 501,	(* Åš Å› *)
    16_015C, 501,	(* Åœ Å *)
    16_015E, 501,	(* Åž ÅŸ *)
    16_0160, 501,	(* Å  Å¡ *)
    16_0162, 501,	(* Å¢ Å£ *)
    16_0164, 501,	(* Å¤ Å¥ *)
    16_0166, 501,	(* Å¦ Å§ *)
    16_0168, 501,	(* Å¨ Å© *)
    16_016A, 501,	(* Åª Å« *)
    16_016C, 501,	(* Å¬ Å­ *)
    16_016E, 501,	(* Å® Å¯ *)
    16_0170, 501,	(* Å° Å± *)
    16_0172, 501,	(* Å² Å³ *)
    16_0174, 501,	(* Å´ Åµ *)
    16_0176, 501,	(* Å¶ Å· *)
    16_0178, 379,	(* Å¸ Ã¿ *)
    16_0179, 501,	(* Å¹ Åº *)
    16_017B, 501,	(* Å» Å¼ *)
    16_017D, 501,	(* Å½ Å¾ *)
    16_0181, 710,	(* Æ É“ *)
    16_0182, 501,	(* Æ‚ Æƒ *)
    16_0184, 501,	(* Æ„ Æ… *)
    16_0186, 706,	(* Æ† É” *)
    16_0187, 501,	(* Æ‡ Æˆ *)
    16_018B, 501,	(* Æ‹ ÆŒ *)
    16_0190, 703,	(* Æ É› *)
    16_0191, 501,	(* Æ‘ Æ’ *)
    16_0193, 705,	(* Æ“ É  *)
    16_0194, 707,	(* Æ” É£ *)
    16_0196, 711,	(* Æ– É© *)
    16_0197, 709,	(* Æ— É¨ *)
    16_0198, 501,	(* Æ˜ Æ™ *)
    16_019C, 711,	(* Æœ É¯ *)
    16_019D, 713,	(* Æ É² *)
    16_01A0, 501,	(* Æ  Æ¡ *)
    16_01A2, 501,	(* Æ¢ Æ£ *)
    16_01A4, 501,	(* Æ¤ Æ¥ *)
    16_01A7, 501,	(* Æ§ Æ¨ *)
    16_01A9, 718,	(* Æ© Êƒ *)
    16_01AC, 501,	(* Æ¬ Æ­ *)
    16_01AE, 718,	(* Æ® Êˆ *)
    16_01AF, 501,	(* Æ¯ Æ° *)
    16_01B3, 501,	(* Æ³ Æ´ *)
    16_01B5, 501,	(* Æµ Æ¶ *)
    16_01B7, 719,	(* Æ· Ê’ *)
    16_01B8, 501,	(* Æ¸ Æ¹ *)
    16_01BC, 501,	(* Æ¼ Æ½ *)
    16_01C4, 502,	(* Ç„ Ç† *)
    16_01C5, 501,	(* Ç… Ç† *)
    16_01C7, 502,	(* Ç‡ Ç‰ *)
    16_01C8, 501,	(* Çˆ Ç‰ *)
    16_01CA, 502,	(* ÇŠ ÇŒ *)
    16_01CB, 501,	(* Ç‹ ÇŒ *)
    16_01CD, 501,	(* Ç ÇŽ *)
    16_01CF, 501,	(* Ç Ç *)
    16_01D1, 501,	(* Ç‘ Ç’ *)
    16_01D3, 501,	(* Ç“ Ç” *)
    16_01D5, 501,	(* Ç• Ç– *)
    16_01D7, 501,	(* Ç— Ç˜ *)
    16_01D9, 501,	(* Ç™ Çš *)
    16_01DB, 501,	(* Ç› Çœ *)
    16_01DE, 501,	(* Çž ÇŸ *)
    16_01E0, 501,	(* Ç  Ç¡ *)
    16_01E2, 501,	(* Ç¢ Ç£ *)
    16_01E4, 501,	(* Ç¤ Ç¥ *)
    16_01E6, 501,	(* Ç¦ Ç§ *)
    16_01E8, 501,	(* Ç¨ Ç© *)
    16_01EA, 501,	(* Çª Ç« *)
    16_01EC, 501,	(* Ç¬ Ç­ *)
    16_01EE, 501,	(* Ç® Ç¯ *)
    16_01F1, 502,	(* Ç± Ç³ *)
    16_01F2, 501,	(* Ç² Ç³ *)
    16_01F4, 501,	(* Ç´ Çµ *)
    16_01FA, 501,	(* Çº Ç» *)
    16_01FC, 501,	(* Ç¼ Ç½ *)
    16_01FE, 501,	(* Ç¾ Ç¿ *)
    16_0200, 501,	(* È€ È *)
    16_0202, 501,	(* È‚ Èƒ *)
    16_0204, 501,	(* È„ È… *)
    16_0206, 501,	(* È† È‡ *)
    16_0208, 501,	(* Èˆ È‰ *)
    16_020A, 501,	(* ÈŠ È‹ *)
    16_020C, 501,	(* ÈŒ È *)
    16_020E, 501,	(* ÈŽ È *)
    16_0210, 501,	(* È È‘ *)
    16_0212, 501,	(* È’ È“ *)
    16_0214, 501,	(* È” È• *)
    16_0216, 501,	(* È– È— *)
    16_0386, 538,	(* Î† Î¬ *)
    16_038C, 564,	(* ÎŒ ÏŒ *)
    16_03E2, 501,	(* Ï¢ Ï£ *)
    16_03E4, 501,	(* Ï¤ Ï¥ *)
    16_03E6, 501,	(* Ï¦ Ï§ *)
    16_03E8, 501,	(* Ï¨ Ï© *)
    16_03EA, 501,	(* Ïª Ï« *)
    16_03EC, 501,	(* Ï¬ Ï­ *)
    16_03EE, 501,	(* Ï® Ï¯ *)
    16_0460, 501,	(* Ñ  Ñ¡ *)
    16_0462, 501,	(* Ñ¢ Ñ£ *)
    16_0464, 501,	(* Ñ¤ Ñ¥ *)
    16_0466, 501,	(* Ñ¦ Ñ§ *)
    16_0468, 501,	(* Ñ¨ Ñ© *)
    16_046A, 501,	(* Ñª Ñ« *)
    16_046C, 501,	(* Ñ¬ Ñ­ *)
    16_046E, 501,	(* Ñ® Ñ¯ *)
    16_0470, 501,	(* Ñ° Ñ± *)
    16_0472, 501,	(* Ñ² Ñ³ *)
    16_0474, 501,	(* Ñ´ Ñµ *)
    16_0476, 501,	(* Ñ¶ Ñ· *)
    16_0478, 501,	(* Ñ¸ Ñ¹ *)
    16_047A, 501,	(* Ñº Ñ» *)
    16_047C, 501,	(* Ñ¼ Ñ½ *)
    16_047E, 501,	(* Ñ¾ Ñ¿ *)
    16_0480, 501,	(* Ò€ Ò *)
    16_0490, 501,	(* Ò Ò‘ *)
    16_0492, 501,	(* Ò’ Ò“ *)
    16_0494, 501,	(* Ò” Ò• *)
    16_0496, 501,	(* Ò– Ò— *)
    16_0498, 501,	(* Ò˜ Ò™ *)
    16_049A, 501,	(* Òš Ò› *)
    16_049C, 501,	(* Òœ Ò *)
    16_049E, 501,	(* Òž ÒŸ *)
    16_04A0, 501,	(* Ò  Ò¡ *)
    16_04A2, 501,	(* Ò¢ Ò£ *)
    16_04A4, 501,	(* Ò¤ Ò¥ *)
    16_04A6, 501,	(* Ò¦ Ò§ *)
    16_04A8, 501,	(* Ò¨ Ò© *)
    16_04AA, 501,	(* Òª Ò« *)
    16_04AC, 501,	(* Ò¬ Ò­ *)
    16_04AE, 501,	(* Ò® Ò¯ *)
    16_04B0, 501,	(* Ò° Ò± *)
    16_04B2, 501,	(* Ò² Ò³ *)
    16_04B4, 501,	(* Ò´ Òµ *)
    16_04B6, 501,	(* Ò¶ Ò· *)
    16_04B8, 501,	(* Ò¸ Ò¹ *)
    16_04BA, 501,	(* Òº Ò» *)
    16_04BC, 501,	(* Ò¼ Ò½ *)
    16_04BE, 501,	(* Ò¾ Ò¿ *)
    16_04C1, 501,	(* Ó Ó‚ *)
    16_04C3, 501,	(* Óƒ Ó„ *)
    16_04C7, 501,	(* Ó‡ Óˆ *)
    16_04CB, 501,	(* Ó‹ ÓŒ *)
    16_04D0, 501,	(* Ó Ó‘ *)
    16_04D2, 501,	(* Ó’ Ó“ *)
    16_04D4, 501,	(* Ó” Ó• *)
    16_04D6, 501,	(* Ó– Ó— *)
    16_04D8, 501,	(* Ó˜ Ó™ *)
    16_04DA, 501,	(* Óš Ó› *)
    16_04DC, 501,	(* Óœ Ó *)
    16_04DE, 501,	(* Óž ÓŸ *)
    16_04E0, 501,	(* Ó  Ó¡ *)
    16_04E2, 501,	(* Ó¢ Ó£ *)
    16_04E4, 501,	(* Ó¤ Ó¥ *)
    16_04E6, 501,	(* Ó¦ Ó§ *)
    16_04E8, 501,	(* Ó¨ Ó© *)
    16_04EA, 501,	(* Óª Ó« *)
    16_04EE, 501,	(* Ó® Ó¯ *)
    16_04F0, 501,	(* Ó° Ó± *)
    16_04F2, 501,	(* Ó² Ó³ *)
    16_04F4, 501,	(* Ó´ Óµ *)
    16_04F8, 501,	(* Ó¸ Ó¹ *)
    16_1E00, 501,	(* á¸€ á¸ *)
    16_1E02, 501,	(* á¸‚ á¸ƒ *)
    16_1E04, 501,	(* á¸„ á¸… *)
    16_1E06, 501,	(* á¸† á¸‡ *)
    16_1E08, 501,	(* á¸ˆ á¸‰ *)
    16_1E0A, 501,	(* á¸Š á¸‹ *)
    16_1E0C, 501,	(* á¸Œ á¸ *)
    16_1E0E, 501,	(* á¸Ž á¸ *)
    16_1E10, 501,	(* á¸ á¸‘ *)
    16_1E12, 501,	(* á¸’ á¸“ *)
    16_1E14, 501,	(* á¸” á¸• *)
    16_1E16, 501,	(* á¸– á¸— *)
    16_1E18, 501,	(* á¸˜ á¸™ *)
    16_1E1A, 501,	(* á¸š á¸› *)
    16_1E1C, 501,	(* á¸œ á¸ *)
    16_1E1E, 501,	(* á¸ž á¸Ÿ *)
    16_1E20, 501,	(* á¸  á¸¡ *)
    16_1E22, 501,	(* á¸¢ á¸£ *)
    16_1E24, 501,	(* á¸¤ á¸¥ *)
    16_1E26, 501,	(* á¸¦ á¸§ *)
    16_1E28, 501,	(* á¸¨ á¸© *)
    16_1E2A, 501,	(* á¸ª á¸« *)
    16_1E2C, 501,	(* á¸¬ á¸­ *)
    16_1E2E, 501,	(* á¸® á¸¯ *)
    16_1E30, 501,	(* á¸° á¸± *)
    16_1E32, 501,	(* á¸² á¸³ *)
    16_1E34, 501,	(* á¸´ á¸µ *)
    16_1E36, 501,	(* á¸¶ á¸· *)
    16_1E38, 501,	(* á¸¸ á¸¹ *)
    16_1E3A, 501,	(* á¸º á¸» *)
    16_1E3C, 501,	(* á¸¼ á¸½ *)
    16_1E3E, 501,	(* á¸¾ á¸¿ *)
    16_1E40, 501,	(* á¹€ á¹ *)
    16_1E42, 501,	(* á¹‚ á¹ƒ *)
    16_1E44, 501,	(* á¹„ á¹… *)
    16_1E46, 501,	(* á¹† á¹‡ *)
    16_1E48, 501,	(* á¹ˆ á¹‰ *)
    16_1E4A, 501,	(* á¹Š á¹‹ *)
    16_1E4C, 501,	(* á¹Œ á¹ *)
    16_1E4E, 501,	(* á¹Ž á¹ *)
    16_1E50, 501,	(* á¹ á¹‘ *)
    16_1E52, 501,	(* á¹’ á¹“ *)
    16_1E54, 501,	(* á¹” á¹• *)
    16_1E56, 501,	(* á¹– á¹— *)
    16_1E58, 501,	(* á¹˜ á¹™ *)
    16_1E5A, 501,	(* á¹š á¹› *)
    16_1E5C, 501,	(* á¹œ á¹ *)
    16_1E5E, 501,	(* á¹ž á¹Ÿ *)
    16_1E60, 501,	(* á¹  á¹¡ *)
    16_1E62, 501,	(* á¹¢ á¹£ *)
    16_1E64, 501,	(* á¹¤ á¹¥ *)
    16_1E66, 501,	(* á¹¦ á¹§ *)
    16_1E68, 501,	(* á¹¨ á¹© *)
    16_1E6A, 501,	(* á¹ª á¹« *)
    16_1E6C, 501,	(* á¹¬ á¹­ *)
    16_1E6E, 501,	(* á¹® á¹¯ *)
    16_1E70, 501,	(* á¹° á¹± *)
    16_1E72, 501,	(* á¹² á¹³ *)
    16_1E74, 501,	(* á¹´ á¹µ *)
    16_1E76, 501,	(* á¹¶ á¹· *)
    16_1E78, 501,	(* á¹¸ á¹¹ *)
    16_1E7A, 501,	(* á¹º á¹» *)
    16_1E7C, 501,	(* á¹¼ á¹½ *)
    16_1E7E, 501,	(* á¹¾ á¹¿ *)
    16_1E80, 501,	(* áº€ áº *)
    16_1E82, 501,	(* áº‚ áºƒ *)
    16_1E84, 501,	(* áº„ áº… *)
    16_1E86, 501,	(* áº† áº‡ *)
    16_1E88, 501,	(* áºˆ áº‰ *)
    16_1E8A, 501,	(* áºŠ áº‹ *)
    16_1E8C, 501,	(* áºŒ áº *)
    16_1E8E, 501,	(* áºŽ áº *)
    16_1E90, 501,	(* áº áº‘ *)
    16_1E92, 501,	(* áº’ áº“ *)
    16_1E94, 501,	(* áº” áº• *)
    16_1EA0, 501,	(* áº  áº¡ *)
    16_1EA2, 501,	(* áº¢ áº£ *)
    16_1EA4, 501,	(* áº¤ áº¥ *)
    16_1EA6, 501,	(* áº¦ áº§ *)
    16_1EA8, 501,	(* áº¨ áº© *)
    16_1EAA, 501,	(* áºª áº« *)
    16_1EAC, 501,	(* áº¬ áº­ *)
    16_1EAE, 501,	(* áº® áº¯ *)
    16_1EB0, 501,	(* áº° áº± *)
    16_1EB2, 501,	(* áº² áº³ *)
    16_1EB4, 501,	(* áº´ áºµ *)
    16_1EB6, 501,	(* áº¶ áº· *)
    16_1EB8, 501,	(* áº¸ áº¹ *)
    16_1EBA, 501,	(* áºº áº» *)
    16_1EBC, 501,	(* áº¼ áº½ *)
    16_1EBE, 501,	(* áº¾ áº¿ *)
    16_1EC0, 501,	(* á»€ á» *)
    16_1EC2, 501,	(* á»‚ á»ƒ *)
    16_1EC4, 501,	(* á»„ á»… *)
    16_1EC6, 501,	(* á»† á»‡ *)
    16_1EC8, 501,	(* á»ˆ á»‰ *)
    16_1ECA, 501,	(* á»Š á»‹ *)
    16_1ECC, 501,	(* á»Œ á» *)
    16_1ECE, 501,	(* á»Ž á» *)
    16_1ED0, 501,	(* á» á»‘ *)
    16_1ED2, 501,	(* á»’ á»“ *)
    16_1ED4, 501,	(* á»” á»• *)
    16_1ED6, 501,	(* á»– á»— *)
    16_1ED8, 501,	(* á»˜ á»™ *)
    16_1EDA, 501,	(* á»š á»› *)
    16_1EDC, 501,	(* á»œ á» *)
    16_1EDE, 501,	(* á»ž á»Ÿ *)
    16_1EE0, 501,	(* á»  á»¡ *)
    16_1EE2, 501,	(* á»¢ á»£ *)
    16_1EE4, 501,	(* á»¤ á»¥ *)
    16_1EE6, 501,	(* á»¦ á»§ *)
    16_1EE8, 501,	(* á»¨ á»© *)
    16_1EEA, 501,	(* á»ª á»« *)
    16_1EEC, 501,	(* á»¬ á»­ *)
    16_1EEE, 501,	(* á»® á»¯ *)
    16_1EF0, 501,	(* á»° á»± *)
    16_1EF2, 501,	(* á»² á»³ *)
    16_1EF4, 501,	(* á»´ á»µ *)
    16_1EF6, 501,	(* á»¶ á»· *)
    16_1EF8, 501,	(* á»¸ á»¹ *)
    16_1F59, 492,	(* á½™ á½‘ *)
    16_1F5B, 492,	(* á½› á½“ *)
    16_1F5D, 492,	(* á½ á½• *)
    16_1F5F, 492,	(* á½Ÿ á½— *)
    16_1FBC, 491,	(* á¾¼ á¾³ *)
    16_1FCC, 491,	(* á¿Œ á¿ƒ *)
    16_1FEC, 493,	(* á¿¬ á¿¥ *)
    16_1FFC, 491	(* á¿¼ á¿³ *)
    };

(*---------------------------------------------------------------------------*}
 * Lower-case ranges  (3rd column is conversion excess 500)
{*---------------------------------------------------------------------------*)

  toupper3 := ARRAY [0..104] OF Ord {
    16_0061, 16_007A, 468, (* a-z A-Z *)
    16_00E0, 16_00F6, 468, (* Ã -Ã¶ Ã€-Ã– *)
    16_00F8, 16_00FE, 468, (* Ã¸-Ã¾ Ã˜-Ãž *)
    16_0256, 16_0257, 295, (* É–-É— Æ‰-ÆŠ *)
    16_0258, 16_0259, 298, (* É˜-É™ ÆŽ-Æ *)
    16_028A, 16_028B, 283, (* ÊŠ-Ê‹ Æ±-Æ² *)
    16_03AD, 16_03AF, 463, (* Î­-Î¯ Îˆ-ÎŠ *)
    16_03B1, 16_03C1, 468, (* Î±-Ï Î‘-Î¡ *)
    16_03C3, 16_03CB, 468, (* Ïƒ-Ï‹ Î£-Î« *)
    16_03CD, 16_03CE, 437, (* Ï-ÏŽ ÎŽ-Î *)
    16_0430, 16_044F, 468, (* Ð°-Ñ Ð-Ð¯ *)
    16_0451, 16_045C, 420, (* Ñ‘-Ñœ Ð-ÐŒ *)
    16_045E, 16_045F, 420, (* Ñž-ÑŸ ÐŽ-Ð *)
    16_0561, 16_0586, 452, (* Õ¡-Ö† Ô±-Õ– *)
    16_1F00, 16_1F07, 508, (* á¼€-á¼‡ á¼ˆ-á¼ *)
    16_1F10, 16_1F15, 508, (* á¼-á¼• á¼˜-á¼ *)
    16_1F20, 16_1F27, 508, (* á¼ -á¼§ á¼¨-á¼¯ *)
    16_1F30, 16_1F37, 508, (* á¼°-á¼· á¼¸-á¼¿ *)
    16_1F40, 16_1F45, 508, (* á½€-á½… á½ˆ-á½ *)
    16_1F60, 16_1F67, 508, (* á½ -á½§ á½¨-á½¯ *)
    16_1F70, 16_1F71, 574, (* á½°-á½± á¾º-á¾» *)
    16_1F72, 16_1F75, 586, (* á½²-á½µ á¿ˆ-á¿‹ *)
    16_1F76, 16_1F77, 600, (* á½¶-á½· á¿š-á¿› *)
    16_1F78, 16_1F79, 628, (* á½¸-á½¹ á¿¸-á¿¹ *)
    16_1F7A, 16_1F7B, 612, (* á½º-á½» á¿ª-á¿« *)
    16_1F7C, 16_1F7D, 626, (* á½¼-á½½ á¿º-á¿» *)
    16_1F80, 16_1F87, 508, (* á¾€-á¾‡ á¾ˆ-á¾ *)
    16_1F90, 16_1F97, 508, (* á¾-á¾— á¾˜-á¾Ÿ *)
    16_1FA0, 16_1FA7, 508, (* á¾ -á¾§ á¾¨-á¾¯ *)
    16_1FB0, 16_1FB1, 508, (* á¾°-á¾± á¾¸-á¾¹ *)
    16_1FD0, 16_1FD1, 508, (* á¿-á¿‘ á¿˜-á¿™ *)
    16_1FE0, 16_1FE1, 508, (* á¿ -á¿¡ á¿¨-á¿© *)
    16_2170, 16_217F, 484, (* â…°-â…¿ â… -â…¯ *)
    16_24D0, 16_24E9, 474, (* â“-â“© â’¶-â“ *)
    16_FF41, 16_FF5A, 468  (* ï½-ï½š ï¼¡-ï¼º *)
    };

(*---------------------------------------------------------------------------*}
 * Lower-case singletons  (2nd column is conversion excess 500)
{*---------------------------------------------------------------------------*)

  toupper2 := ARRAY [0..679] OF Ord {
    16_00FF, 621, (* Ã¿ Å¸ *)
    16_0101, 499, (* Ä Ä€ *)
    16_0103, 499, (* Äƒ Ä‚ *)
    16_0105, 499, (* Ä… Ä„ *)
    16_0107, 499, (* Ä‡ Ä† *)
    16_0109, 499, (* Ä‰ Äˆ *)
    16_010B, 499, (* Ä‹ ÄŠ *)
    16_010D, 499, (* Ä ÄŒ *)
    16_010F, 499, (* Ä ÄŽ *)
    16_0111, 499, (* Ä‘ Ä *)
    16_0113, 499, (* Ä“ Ä’ *)
    16_0115, 499, (* Ä• Ä” *)
    16_0117, 499, (* Ä— Ä– *)
    16_0119, 499, (* Ä™ Ä˜ *)
    16_011B, 499, (* Ä› Äš *)
    16_011D, 499, (* Ä Äœ *)
    16_011F, 499, (* ÄŸ Äž *)
    16_0121, 499, (* Ä¡ Ä  *)
    16_0123, 499, (* Ä£ Ä¢ *)
    16_0125, 499, (* Ä¥ Ä¤ *)
    16_0127, 499, (* Ä§ Ä¦ *)
    16_0129, 499, (* Ä© Ä¨ *)
    16_012B, 499, (* Ä« Äª *)
    16_012D, 499, (* Ä­ Ä¬ *)
    16_012F, 499, (* Ä¯ Ä® *)
    16_0131, 268, (* Ä± I *)
    16_0133, 499, (* Ä³ Ä² *)
    16_0135, 499, (* Äµ Ä´ *)
    16_0137, 499, (* Ä· Ä¶ *)
    16_013A, 499, (* Äº Ä¹ *)
    16_013C, 499, (* Ä¼ Ä» *)
    16_013E, 499, (* Ä¾ Ä½ *)
    16_0140, 499, (* Å€ Ä¿ *)
    16_0142, 499, (* Å‚ Å *)
    16_0144, 499, (* Å„ Åƒ *)
    16_0146, 499, (* Å† Å… *)
    16_0148, 499, (* Åˆ Å‡ *)
    16_014B, 499, (* Å‹ ÅŠ *)
    16_014D, 499, (* Å ÅŒ *)
    16_014F, 499, (* Å ÅŽ *)
    16_0151, 499, (* Å‘ Å *)
    16_0153, 499, (* Å“ Å’ *)
    16_0155, 499, (* Å• Å” *)
    16_0157, 499, (* Å— Å– *)
    16_0159, 499, (* Å™ Å˜ *)
    16_015B, 499, (* Å› Åš *)
    16_015D, 499, (* Å Åœ *)
    16_015F, 499, (* ÅŸ Åž *)
    16_0161, 499, (* Å¡ Å  *)
    16_0163, 499, (* Å£ Å¢ *)
    16_0165, 499, (* Å¥ Å¤ *)
    16_0167, 499, (* Å§ Å¦ *)
    16_0169, 499, (* Å© Å¨ *)
    16_016B, 499, (* Å« Åª *)
    16_016D, 499, (* Å­ Å¬ *)
    16_016F, 499, (* Å¯ Å® *)
    16_0171, 499, (* Å± Å° *)
    16_0173, 499, (* Å³ Å² *)
    16_0175, 499, (* Åµ Å´ *)
    16_0177, 499, (* Å· Å¶ *)
    16_017A, 499, (* Åº Å¹ *)
    16_017C, 499, (* Å¼ Å» *)
    16_017E, 499, (* Å¾ Å½ *)
    16_017F, 200, (* Å¿ S *)
    16_0183, 499, (* Æƒ Æ‚ *)
    16_0185, 499, (* Æ… Æ„ *)
    16_0188, 499, (* Æˆ Æ‡ *)
    16_018C, 499, (* ÆŒ Æ‹ *)
    16_0192, 499, (* Æ’ Æ‘ *)
    16_0199, 499, (* Æ™ Æ˜ *)
    16_01A1, 499, (* Æ¡ Æ  *)
    16_01A3, 499, (* Æ£ Æ¢ *)
    16_01A5, 499, (* Æ¥ Æ¤ *)
    16_01A8, 499, (* Æ¨ Æ§ *)
    16_01AD, 499, (* Æ­ Æ¬ *)
    16_01B0, 499, (* Æ° Æ¯ *)
    16_01B4, 499, (* Æ´ Æ³ *)
    16_01B6, 499, (* Æ¶ Æµ *)
    16_01B9, 499, (* Æ¹ Æ¸ *)
    16_01BD, 499, (* Æ½ Æ¼ *)
    16_01C5, 499, (* Ç… Ç„ *)
    16_01C6, 498, (* Ç† Ç„ *)
    16_01C8, 499, (* Çˆ Ç‡ *)
    16_01C9, 498, (* Ç‰ Ç‡ *)
    16_01CB, 499, (* Ç‹ ÇŠ *)
    16_01CC, 498, (* ÇŒ ÇŠ *)
    16_01CE, 499, (* ÇŽ Ç *)
    16_01D0, 499, (* Ç Ç *)
    16_01D2, 499, (* Ç’ Ç‘ *)
    16_01D4, 499, (* Ç” Ç“ *)
    16_01D6, 499, (* Ç– Ç• *)
    16_01D8, 499, (* Ç˜ Ç— *)
    16_01DA, 499, (* Çš Ç™ *)
    16_01DC, 499, (* Çœ Ç› *)
    16_01DF, 499, (* ÇŸ Çž *)
    16_01E1, 499, (* Ç¡ Ç  *)
    16_01E3, 499, (* Ç£ Ç¢ *)
    16_01E5, 499, (* Ç¥ Ç¤ *)
    16_01E7, 499, (* Ç§ Ç¦ *)
    16_01E9, 499, (* Ç© Ç¨ *)
    16_01EB, 499, (* Ç« Çª *)
    16_01ED, 499, (* Ç­ Ç¬ *)
    16_01EF, 499, (* Ç¯ Ç® *)
    16_01F2, 499, (* Ç² Ç± *)
    16_01F3, 498, (* Ç³ Ç± *)
    16_01F5, 499, (* Çµ Ç´ *)
    16_01FB, 499, (* Ç» Çº *)
    16_01FD, 499, (* Ç½ Ç¼ *)
    16_01FF, 499, (* Ç¿ Ç¾ *)
    16_0201, 499, (* È È€ *)
    16_0203, 499, (* Èƒ È‚ *)
    16_0205, 499, (* È… È„ *)
    16_0207, 499, (* È‡ È† *)
    16_0209, 499, (* È‰ Èˆ *)
    16_020B, 499, (* È‹ ÈŠ *)
    16_020D, 499, (* È ÈŒ *)
    16_020F, 499, (* È ÈŽ *)
    16_0211, 499, (* È‘ È *)
    16_0213, 499, (* È“ È’ *)
    16_0215, 499, (* È• È” *)
    16_0217, 499, (* È— È– *)
    16_0253, 290, (* É“ Æ *)
    16_0254, 294, (* É” Æ† *)
    16_025B, 297, (* É› Æ *)
    16_0260, 295, (* É  Æ“ *)
    16_0263, 293, (* É£ Æ” *)
    16_0268, 291, (* É¨ Æ— *)
    16_0269, 289, (* É© Æ– *)
    16_026F, 289, (* É¯ Æœ *)
    16_0272, 287, (* É² Æ *)
    16_0283, 282, (* Êƒ Æ© *)
    16_0288, 282, (* Êˆ Æ® *)
    16_0292, 281, (* Ê’ Æ· *)
    16_03AC, 462, (* Î¬ Î† *)
    16_03CC, 436, (* ÏŒ ÎŒ *)
    16_03D0, 438, (* Ï Î’ *)
    16_03D1, 443, (* Ï‘ Î˜ *)
    16_03D5, 453, (* Ï• Î¦ *)
    16_03D6, 446, (* Ï– Î  *)
    16_03E3, 499, (* Ï£ Ï¢ *)
    16_03E5, 499, (* Ï¥ Ï¤ *)
    16_03E7, 499, (* Ï§ Ï¦ *)
    16_03E9, 499, (* Ï© Ï¨ *)
    16_03EB, 499, (* Ï« Ïª *)
    16_03ED, 499, (* Ï­ Ï¬ *)
    16_03EF, 499, (* Ï¯ Ï® *)
    16_03F0, 414, (* Ï° Îš *)
    16_03F1, 420, (* Ï± Î¡ *)
    16_0461, 499, (* Ñ¡ Ñ  *)
    16_0463, 499, (* Ñ£ Ñ¢ *)
    16_0465, 499, (* Ñ¥ Ñ¤ *)
    16_0467, 499, (* Ñ§ Ñ¦ *)
    16_0469, 499, (* Ñ© Ñ¨ *)
    16_046B, 499, (* Ñ« Ñª *)
    16_046D, 499, (* Ñ­ Ñ¬ *)
    16_046F, 499, (* Ñ¯ Ñ® *)
    16_0471, 499, (* Ñ± Ñ° *)
    16_0473, 499, (* Ñ³ Ñ² *)
    16_0475, 499, (* Ñµ Ñ´ *)
    16_0477, 499, (* Ñ· Ñ¶ *)
    16_0479, 499, (* Ñ¹ Ñ¸ *)
    16_047B, 499, (* Ñ» Ñº *)
    16_047D, 499, (* Ñ½ Ñ¼ *)
    16_047F, 499, (* Ñ¿ Ñ¾ *)
    16_0481, 499, (* Ò Ò€ *)
    16_0491, 499, (* Ò‘ Ò *)
    16_0493, 499, (* Ò“ Ò’ *)
    16_0495, 499, (* Ò• Ò” *)
    16_0497, 499, (* Ò— Ò– *)
    16_0499, 499, (* Ò™ Ò˜ *)
    16_049B, 499, (* Ò› Òš *)
    16_049D, 499, (* Ò Òœ *)
    16_049F, 499, (* ÒŸ Òž *)
    16_04A1, 499, (* Ò¡ Ò  *)
    16_04A3, 499, (* Ò£ Ò¢ *)
    16_04A5, 499, (* Ò¥ Ò¤ *)
    16_04A7, 499, (* Ò§ Ò¦ *)
    16_04A9, 499, (* Ò© Ò¨ *)
    16_04AB, 499, (* Ò« Òª *)
    16_04AD, 499, (* Ò­ Ò¬ *)
    16_04AF, 499, (* Ò¯ Ò® *)
    16_04B1, 499, (* Ò± Ò° *)
    16_04B3, 499, (* Ò³ Ò² *)
    16_04B5, 499, (* Òµ Ò´ *)
    16_04B7, 499, (* Ò· Ò¶ *)
    16_04B9, 499, (* Ò¹ Ò¸ *)
    16_04BB, 499, (* Ò» Òº *)
    16_04BD, 499, (* Ò½ Ò¼ *)
    16_04BF, 499, (* Ò¿ Ò¾ *)
    16_04C2, 499, (* Ó‚ Ó *)
    16_04C4, 499, (* Ó„ Óƒ *)
    16_04C8, 499, (* Óˆ Ó‡ *)
    16_04CC, 499, (* ÓŒ Ó‹ *)
    16_04D1, 499, (* Ó‘ Ó *)
    16_04D3, 499, (* Ó“ Ó’ *)
    16_04D5, 499, (* Ó• Ó” *)
    16_04D7, 499, (* Ó— Ó– *)
    16_04D9, 499, (* Ó™ Ó˜ *)
    16_04DB, 499, (* Ó› Óš *)
    16_04DD, 499, (* Ó Óœ *)
    16_04DF, 499, (* ÓŸ Óž *)
    16_04E1, 499, (* Ó¡ Ó  *)
    16_04E3, 499, (* Ó£ Ó¢ *)
    16_04E5, 499, (* Ó¥ Ó¤ *)
    16_04E7, 499, (* Ó§ Ó¦ *)
    16_04E9, 499, (* Ó© Ó¨ *)
    16_04EB, 499, (* Ó« Óª *)
    16_04EF, 499, (* Ó¯ Ó® *)
    16_04F1, 499, (* Ó± Ó° *)
    16_04F3, 499, (* Ó³ Ó² *)
    16_04F5, 499, (* Óµ Ó´ *)
    16_04F9, 499, (* Ó¹ Ó¸ *)
    16_1E01, 499, (* á¸ á¸€ *)
    16_1E03, 499, (* á¸ƒ á¸‚ *)
    16_1E05, 499, (* á¸… á¸„ *)
    16_1E07, 499, (* á¸‡ á¸† *)
    16_1E09, 499, (* á¸‰ á¸ˆ *)
    16_1E0B, 499, (* á¸‹ á¸Š *)
    16_1E0D, 499, (* á¸ á¸Œ *)
    16_1E0F, 499, (* á¸ á¸Ž *)
    16_1E11, 499, (* á¸‘ á¸ *)
    16_1E13, 499, (* á¸“ á¸’ *)
    16_1E15, 499, (* á¸• á¸” *)
    16_1E17, 499, (* á¸— á¸– *)
    16_1E19, 499, (* á¸™ á¸˜ *)
    16_1E1B, 499, (* á¸› á¸š *)
    16_1E1D, 499, (* á¸ á¸œ *)
    16_1E1F, 499, (* á¸Ÿ á¸ž *)
    16_1E21, 499, (* á¸¡ á¸  *)
    16_1E23, 499, (* á¸£ á¸¢ *)
    16_1E25, 499, (* á¸¥ á¸¤ *)
    16_1E27, 499, (* á¸§ á¸¦ *)
    16_1E29, 499, (* á¸© á¸¨ *)
    16_1E2B, 499, (* á¸« á¸ª *)
    16_1E2D, 499, (* á¸­ á¸¬ *)
    16_1E2F, 499, (* á¸¯ á¸® *)
    16_1E31, 499, (* á¸± á¸° *)
    16_1E33, 499, (* á¸³ á¸² *)
    16_1E35, 499, (* á¸µ á¸´ *)
    16_1E37, 499, (* á¸· á¸¶ *)
    16_1E39, 499, (* á¸¹ á¸¸ *)
    16_1E3B, 499, (* á¸» á¸º *)
    16_1E3D, 499, (* á¸½ á¸¼ *)
    16_1E3F, 499, (* á¸¿ á¸¾ *)
    16_1E41, 499, (* á¹ á¹€ *)
    16_1E43, 499, (* á¹ƒ á¹‚ *)
    16_1E45, 499, (* á¹… á¹„ *)
    16_1E47, 499, (* á¹‡ á¹† *)
    16_1E49, 499, (* á¹‰ á¹ˆ *)
    16_1E4B, 499, (* á¹‹ á¹Š *)
    16_1E4D, 499, (* á¹ á¹Œ *)
    16_1E4F, 499, (* á¹ á¹Ž *)
    16_1E51, 499, (* á¹‘ á¹ *)
    16_1E53, 499, (* á¹“ á¹’ *)
    16_1E55, 499, (* á¹• á¹” *)
    16_1E57, 499, (* á¹— á¹– *)
    16_1E59, 499, (* á¹™ á¹˜ *)
    16_1E5B, 499, (* á¹› á¹š *)
    16_1E5D, 499, (* á¹ á¹œ *)
    16_1E5F, 499, (* á¹Ÿ á¹ž *)
    16_1E61, 499, (* á¹¡ á¹  *)
    16_1E63, 499, (* á¹£ á¹¢ *)
    16_1E65, 499, (* á¹¥ á¹¤ *)
    16_1E67, 499, (* á¹§ á¹¦ *)
    16_1E69, 499, (* á¹© á¹¨ *)
    16_1E6B, 499, (* á¹« á¹ª *)
    16_1E6D, 499, (* á¹­ á¹¬ *)
    16_1E6F, 499, (* á¹¯ á¹® *)
    16_1E71, 499, (* á¹± á¹° *)
    16_1E73, 499, (* á¹³ á¹² *)
    16_1E75, 499, (* á¹µ á¹´ *)
    16_1E77, 499, (* á¹· á¹¶ *)
    16_1E79, 499, (* á¹¹ á¹¸ *)
    16_1E7B, 499, (* á¹» á¹º *)
    16_1E7D, 499, (* á¹½ á¹¼ *)
    16_1E7F, 499, (* á¹¿ á¹¾ *)
    16_1E81, 499, (* áº áº€ *)
    16_1E83, 499, (* áºƒ áº‚ *)
    16_1E85, 499, (* áº… áº„ *)
    16_1E87, 499, (* áº‡ áº† *)
    16_1E89, 499, (* áº‰ áºˆ *)
    16_1E8B, 499, (* áº‹ áºŠ *)
    16_1E8D, 499, (* áº áºŒ *)
    16_1E8F, 499, (* áº áºŽ *)
    16_1E91, 499, (* áº‘ áº *)
    16_1E93, 499, (* áº“ áº’ *)
    16_1E95, 499, (* áº• áº” *)
    16_1EA1, 499, (* áº¡ áº  *)
    16_1EA3, 499, (* áº£ áº¢ *)
    16_1EA5, 499, (* áº¥ áº¤ *)
    16_1EA7, 499, (* áº§ áº¦ *)
    16_1EA9, 499, (* áº© áº¨ *)
    16_1EAB, 499, (* áº« áºª *)
    16_1EAD, 499, (* áº­ áº¬ *)
    16_1EAF, 499, (* áº¯ áº® *)
    16_1EB1, 499, (* áº± áº° *)
    16_1EB3, 499, (* áº³ áº² *)
    16_1EB5, 499, (* áºµ áº´ *)
    16_1EB7, 499, (* áº· áº¶ *)
    16_1EB9, 499, (* áº¹ áº¸ *)
    16_1EBB, 499, (* áº» áºº *)
    16_1EBD, 499, (* áº½ áº¼ *)
    16_1EBF, 499, (* áº¿ áº¾ *)
    16_1EC1, 499, (* á» á»€ *)
    16_1EC3, 499, (* á»ƒ á»‚ *)
    16_1EC5, 499, (* á»… á»„ *)
    16_1EC7, 499, (* á»‡ á»† *)
    16_1EC9, 499, (* á»‰ á»ˆ *)
    16_1ECB, 499, (* á»‹ á»Š *)
    16_1ECD, 499, (* á» á»Œ *)
    16_1ECF, 499, (* á» á»Ž *)
    16_1ED1, 499, (* á»‘ á» *)
    16_1ED3, 499, (* á»“ á»’ *)
    16_1ED5, 499, (* á»• á»” *)
    16_1ED7, 499, (* á»— á»– *)
    16_1ED9, 499, (* á»™ á»˜ *)
    16_1EDB, 499, (* á»› á»š *)
    16_1EDD, 499, (* á» á»œ *)
    16_1EDF, 499, (* á»Ÿ á»ž *)
    16_1EE1, 499, (* á»¡ á»  *)
    16_1EE3, 499, (* á»£ á»¢ *)
    16_1EE5, 499, (* á»¥ á»¤ *)
    16_1EE7, 499, (* á»§ á»¦ *)
    16_1EE9, 499, (* á»© á»¨ *)
    16_1EEB, 499, (* á»« á»ª *)
    16_1EED, 499, (* á»­ á»¬ *)
    16_1EEF, 499, (* á»¯ á»® *)
    16_1EF1, 499, (* á»± á»° *)
    16_1EF3, 499, (* á»³ á»² *)
    16_1EF5, 499, (* á»µ á»´ *)
    16_1EF7, 499, (* á»· á»¶ *)
    16_1EF9, 499, (* á»¹ á»¸ *)
    16_1F51, 508, (* á½‘ á½™ *)
    16_1F53, 508, (* á½“ á½› *)
    16_1F55, 508, (* á½• á½ *)
    16_1F57, 508, (* á½— á½Ÿ *)
    16_1FB3, 509, (* á¾³ á¾¼ *)
    16_1FC3, 509, (* á¿ƒ á¿Œ *)
    16_1FE5, 507, (* á¿¥ á¿¬ *)
    16_1FF3, 509  (* á¿³ á¿¼ *)
    };

(*---------------------------------------------------------------------------*}
 * Lower-case singletons that have title-case equivalents 
 *   (2nd col. conversion excess 500)
{*---------------------------------------------------------------------------*)

  totitle2 := ARRAY [0..15] OF Ord {
    16_01C4, 501,	(* Ç„ Ç… *)
    16_01C6, 499,	(* Ç† Ç… *)
    16_01C7, 501,	(* Ç‡ Çˆ *)
    16_01C9, 499,	(* Ç‰ Çˆ *)
    16_01CA, 501,	(* ÇŠ Ç‹ *)
    16_01CC, 499,	(* ÇŒ Ç‹ *)
    16_01F1, 501,	(* Ç± Ç² *)
    16_01F3, 499	(* Ç³ Ç² *)
    };
    
(*===========================================================================*}
 * EXPORTED PROCEDURES
{*===========================================================================*)

PROCEDURE IsDefined (t: T): BOOLEAN =
  BEGIN
    IF ORD (t) > 16_FFFD THEN RETURN FALSE END;
    IF ORD (t) < 16_D800 OR ORD (t) > 16_DFFF THEN RETURN TRUE END;
    RETURN FALSE;
  END IsDefined;

PROCEDURE IsASCII (t: T): BOOLEAN =
  BEGIN
    RETURN ORD (t) <= ORD (LAST (CHAR));
  END IsASCII;

PROCEDURE IsSpace (t: T): BOOLEAN =
  VAR p := BSearch (t, ADR (space2), NUMBER (space2) DIV 2, 2);
  BEGIN
    IF p # NIL AND  p^ <= ORD (t) AND 
      ORD (t) <= LOOPHOLE(p + ADRSIZE (Ord), Ptr)^ THEN
      RETURN TRUE;
    END;
    RETURN FALSE;
  END IsSpace;

PROCEDURE IsLetter (t: T): BOOLEAN =
  VAR p: Ptr;
  BEGIN
    IF IsUpperCase (t) OR IsLowerCase (t) THEN RETURN TRUE END;
    p := BSearch (t, ADR (alpha2), NUMBER (alpha2) DIV 2, 2);
    IF p # NIL AND p^ <= ORD (t) AND 
      ORD (t) <= LOOPHOLE(p + ADRSIZE (Ord), Ptr)^ THEN
      RETURN TRUE;
    END;
    p := BSearch (t, ADR (alpha1), NUMBER (alpha1), 1);
    IF p # NIL AND ORD (t) = p^ THEN RETURN TRUE END;
    RETURN FALSE;
  END IsLetter;

PROCEDURE IsDigit (t: T): BOOLEAN =
  VAR p := BSearch (t, ADR (digit2), NUMBER (digit2) DIV 2, 2);
  BEGIN
    IF p # NIL AND p^ <= ORD (t) AND 
      ORD (t) <= LOOPHOLE(p + ADRSIZE (Ord), Ptr)^ THEN
      RETURN TRUE;
    END;
    RETURN FALSE;
  END IsDigit;

PROCEDURE IsLetterOrDigit (t: T): BOOLEAN =
  BEGIN
    RETURN IsLetter (t) OR IsDigit (t);
  END IsLetterOrDigit;

PROCEDURE IsUpperCase (t: T): BOOLEAN =
  VAR p: Ptr;
  BEGIN
    p := BSearch (t, ADR (tolower3), NUMBER (tolower3) DIV 3, 3);
    IF p # NIL AND p^ <= ORD (t) AND 
      ORD (t) <= LOOPHOLE(p + ADRSIZE (Ord), Ptr)^ THEN 
      RETURN TRUE;
    END;
    p := BSearch (t, ADR (tolower2), NUMBER (tolower2) DIV 2, 2);
    IF p # NIL AND p^ = ORD (t) THEN RETURN TRUE END;
    RETURN FALSE;
  END IsUpperCase;

PROCEDURE IsLowerCase (t: T): BOOLEAN =
  VAR p: Ptr;
  BEGIN
    p := BSearch (t, ADR (toupper3), NUMBER (toupper3) DIV 3, 3);
    IF p # NIL AND p^ <= ORD (t) AND 
      ORD (t) <= LOOPHOLE(p + ADRSIZE (Ord), Ptr)^ THEN 
      RETURN TRUE;
    END;
    p := BSearch (t, ADR (toupper2), NUMBER (toupper2) DIV 2, 2);
    IF p # NIL AND p^ = ORD (t) THEN RETURN TRUE END;
    RETURN FALSE;
  END IsLowerCase;

PROCEDURE IsTitleCase (t: T): BOOLEAN =
  BEGIN
    RETURN IsLowerCase (t) AND IsUpperCase (t);
  END IsTitleCase;

PROCEDURE ToUpperCase (t: T): T =
  VAR p := BSearch (t, ADR (toupper3), NUMBER (toupper3) DIV 3, 3);
  BEGIN
    IF p # NIL AND p^ <= ORD (t) AND 
      ORD (t) <= LOOPHOLE(p + ADRSIZE (Ord), Ptr)^ THEN
      RETURN VAL (ORD (t) + LOOPHOLE(p + 2 * ADRSIZE (Ord), Ptr)^ - 500, T);
    END;
    p := BSearch (t, ADR (toupper2), NUMBER (toupper2) DIV 2, 2);
    IF p # NIL AND ORD (t) = p^ THEN
      RETURN VAL (ORD (t) + LOOPHOLE(p + ADRSIZE (Ord), Ptr)^ - 500, T);
    END;
    RETURN t;
  END ToUpperCase;

PROCEDURE ToLowerCase (t: T): T =
  VAR p := BSearch (t, ADR (tolower3), NUMBER (tolower3) DIV 3, 3);
  BEGIN
    IF p # NIL AND p^ <= ORD (t) AND 
      ORD (t) <= LOOPHOLE(p + ADRSIZE (Ord), Ptr)^ THEN
      RETURN VAL (ORD (t) + LOOPHOLE(p + 2 * ADRSIZE (Ord), Ptr)^ - 500, T);
    END;
    p := BSearch (t, ADR (tolower2), NUMBER (tolower2) DIV 2, 2);
    IF p # NIL AND p^ = ORD (t) THEN
      RETURN VAL (ORD (t) + LOOPHOLE(p + ADRSIZE (Ord), Ptr)^ - 500, T);
    END;
    RETURN t;
  END ToLowerCase;

PROCEDURE ToTitleCase (t: T): T =
  VAR p := BSearch (t, ADR (totitle2), NUMBER (totitle2) DIV 2, 2);
  BEGIN
    IF p # NIL AND p^ = ORD (t) THEN
      RETURN VAL (ORD (t) + LOOPHOLE(p + ADRSIZE (Ord), Ptr)^ - 500, T);
    END;
    RETURN t;
  END ToTitleCase;

PROCEDURE ToDigitValue (t: T): CARDINAL =
  VAR p := BSearch (t, ADR (digit2), NUMBER (digit2) DIV 2, 2);
  BEGIN
    IF p # NIL AND p^ <= ORD (t) AND 
      ORD (t) <= LOOPHOLE(p + ADRSIZE (Ord), Ptr)^ THEN    
      IF p^ = 16_0BE7 OR p^ = 16_1369 THEN
        (* Tamils and Ethiopians have no zero digit *)
        RETURN ORD (t) - p^ + 1;
      ELSE
        RETURN ORD (t) - p^;
      END;
    ELSE
      RETURN LAST (CARDINAL);
    END;
  END ToDigitValue;

(*===========================================================================*}
 * LOCAL PROCEDURES
{*===========================================================================*)

(*---------------------------------------------------------------------------*}
 * BSearch  -  Binary Search of a Codepoint Range Table
 *             Arguments: t  -  wide character
 *                        r  -  pointer to range tuple table
 *                        n  -  nbr of tuple entries
 *                        a  -  tuple arity
 *             Returns: ptr -  Pointer to tuple or NIL
{*---------------------------------------------------------------------------*)

PROCEDURE BSearch (c: T;  r: Ptr;  n, a: INTEGER): Ptr =
  VAR tsize := a * ADRSIZE (Ord);  p: Ptr;  m: INTEGER;
  BEGIN
    WHILE n > 1 DO
      m := n DIV 2;
      p := r + m * tsize;
      IF ORD (c) >= p^ THEN
        r := p;
        n := n - m;
      ELSE
        n := m;
      END;
    END;
    IF n > 0 AND ORD (c) >= r^ THEN RETURN r END;
    RETURN NIL;
  END BSearch;

BEGIN
END Unicode.
(* vi: set ai sw=2 ts=2 tw=80: *)
