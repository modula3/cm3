CVSUP(1)                FreeBSD General Commands Manual               CVSUP(1)

NNAAMMEE
     ccvvssuupp - network distribution package for CVS repositories

SSYYNNOOPPSSIISS
     ccvvssuupp [--11aaDDeeEEggkkssvvzzZZ] [--AA _a_d_d_r] [--bb _b_a_s_e] [--cc _c_o_l_l_D_i_r] [--dd _d_e_l_L_i_m_i_t]
           [--hh _h_o_s_t] [--ii _p_a_t_t_e_r_n] [--ll _l_o_c_k_f_i_l_e] [--LL _v_e_r_b_o_s_i_t_y] [--pp _p_o_r_t]
           [--PP _m_|_a_|_p_o_r_t_|_l_o_-_h_i_|_-] [--rr _m_a_x_R_e_t_r_i_e_s] _s_u_p_f_i_l_e [_d_e_s_t_D_i_r]

DDEESSCCRRIIPPTTIIOONN
     CCVVSSuupp is a software package for distributing and updating collections of
     files across a network.  The name CCVVSSuupp refers to the package as a whole.
     It consists of a client program, ccvvssuupp, and a server program, ccvvssuuppdd.
     This manual page describes the general aspects of the CCVVSSuupp package, as
     well as the particulars of the ccvvssuupp client program.  For detailed infor-
     mation about ccvvssuuppdd, see cvsupd(8).

     Unlike more traditional network distribution packages, such as rrddiisstt and
     ssuupp, CCVVSSuupp has specific optimizations for distributing CVS repositories.
     CCVVSSuupp takes advantage of the properties of CVS repositories and the files
     they contain (in particular, RCS files), enabling it to perform updates
     much faster than traditional systems.

     CCVVSSuupp is a general-purpose network file updating package.  It is
     extremely fast, even for collections of files which have nothing to do
     with CVS or RCS.

OOPPTTIIOONNSS
     The client program ccvvssuupp requires at least a single argument, _s_u_p_f_i_l_e.
     It names a file describing one or more collections of files to be trans-
     ferred and/or updated from the server.  The _s_u_p_f_i_l_e has a format similar
     to the corresponding file used by ssuupp.  In most cases, ccvvssuupp can use
     existing ssuupp _s_u_p_f_i_l_e_s.

     An optional argument _d_e_s_t_D_i_r may also be specified.  If given, it names a
     directory under which all updated files will be placed.  When _d_e_s_t_D_i_r is
     specified, the client's original files are left untouched.  This feature
     is primarily intended for testing.

     The following options are supported by ccvvssuupp:

     --11          Disables automatic retries when transient failures occur and
                 the GUI is not being used.  Without this option, a transient
                 failure such as a dropped network connection causes ccvvssuupp to
                 retry repeatedly, using randomized exponential backoff to
                 space the retries.  This option is equivalent to --rr 00,, and is
                 implied when the GUI is used.

     --aa          Requires the server to authenticate itself (prove its iden-
                 tity) to the client.  If authentication of the server fails,
                 the update is canceled.  See _A_U_T_H_E_N_T_I_C_A_T_I_O_N, below.

     --AA _a_d_d_r     Specifies a local address (dotted quad or hostname) to bind
                 to when connecting to the server.  This may be useful on
                 hosts which have multiple IP addresses.

     --bb _b_a_s_e     Specifies the base directory under which ccvvssuupp will maintain
                 its bookkeeping files, overriding any bbaassee specifications in
                 the _s_u_p_f_i_l_e.

     --cc _c_o_l_l_D_i_r  Specifies the subdirectory of _b_a_s_e where the information
                 about the collections is maintained.  The default is _s_u_p.

     --dd _d_e_l_L_i_m_i_t
                 Specifies the maximum number of files that may be deleted in
                 a single update run.  Any attempt to exceed the limit results
                 in a fatal error.  This can provide some protection against
                 temporary configuration mistakes on the server.  The default
                 limit is infinity.

     --DD          Causes ccvvssuupp to perform file deletions only, omitting all
                 other kinds of updates.  This is useful in some situations
                 where disk space on the client is very limited.  One can
                 first run ccvvssuupp with the --DD option, to free up as much space
                 as possible.  Then a second run can be made, this time with-
                 out the --DD option.  If files or directories have been renamed
                 on the server, this technique ensures that all of the old
                 files are deleted on the client before any of the new ones
                 are created.  This option is not implemented yet for checkout
                 mode.

     --ee          Enables the execution of shell commands received from the
                 server, as if the eexxeeccuuttee keyword were added to every collec-
                 tion in the _s_u_p_f_i_l_e.

     --EE          Disables the execution of shell commands received from the
                 server, as if the eexxeeccuuttee keyword were removed from every
                 collection in the _s_u_p_f_i_l_e.

     --gg          Disables the use of the graphical user interface.  This
                 option is implied if the DISPLAY environment variable is not
                 set.

     --hh _h_o_s_t     Specifies the server host to contact, overriding any hhoosstt
                 specifications in the _s_u_p_f_i_l_e.

     --ii _p_a_t_t_e_r_n  Causes ccvvssuupp to include only files and directories matching
                 _p_a_t_t_e_r_n in the update.  If a directory matches the pattern,
                 then the entire subtree rooted at the directory is included.
                 If this option is specified multiple times, the patterns are
                 combined using the `or' operation.  If no --ii options are
                 given, the default is to update all files in each collection.

                 The _p_a_t_t_e_r_n is a standard file name pattern.  It is inter-
                 preted relative to the collection's prefix directory.  Slash
                 characters are matched only by explicit slashes in the pat-
                 tern.  Leading periods in file name are not treated spe-
                 cially.

                 The GUI has a `Filter' type-in field where the patterns may
                 be edited.

     --kk          Causes ccvvssuupp to keep the temporary copies of any incorrectly
                 edited files, in the event of checksum mismatches.  This
                 option is for debugging, to help determine why the files were
                 edited incorrectly.  Regardless of whether this option is
                 specified, the permanent versions of faulty files are
                 replaced with correct versions obtained by transferring the
                 files in their entirety.  Such transfers are called fixups.

     --ll _l_o_c_k_f_i_l_e
                 Creates and locks the _l_o_c_k_f_i_l_e while the update is in
                 progress.  If _l_o_c_k_f_i_l_e is already locked, ccvvssuupp fails without
                 performing automatic retries.  This option is useful when
                 ccvvssuupp is executed periodically from ccrroonn.  It prevents a job
                 from interfering with an earlier job that is perhaps taking
                 extra long because of network problems.

                 POSIX-style file locking is used, as described in fcntl(2).
                 The process-ID is written to the lock file in text form when
                 the lock is successfully acquired.  Upon termination of the
                 update, the lock file is removed.

     --LL _v_e_r_b_o_s_i_t_y
                 Sets the verbosity level for non-GUI output.  A level of 0
                 causes ccvvssuupp to be completely silent unless errors occur.  A
                 level of 1 (the default) causes each updated file to be
                 listed.  A level of 2 provides more detailed information
                 about the updates performed on each file.  All messages are
                 directed to the standard output.  This option is ignored when
                 the GUI is used.

     --pp _p_o_r_t     Sets the TCP port to which ccvvssuupp attempts to connect on the
                 server host.  This feature is primarily for testing.  The
                 default port is 5999.  When not in passive mode (see the
                 description of the --PP option), the server also uses the next
                 lower port to establish a second connection back to the
                 client.

     --PP _m_|_a_|_p_o_r_t_|_l_o_-_h_i_|_-
                 Controls the establishment of the auxiliary TCP connection(s)
                 used to carry information between the client and the server.
                 Altogether, the client and server require four unidirectional
                 channels to communicate: two from the client to the server,
                 and two from the server to the client.  These four unidirec-
                 tional channels can be set up in different ways, to support
                 various firewall setups.  The modes provided for this are
                 multiplexed mode, passive mode, and active mode.  All but
                 multiplexed mode are deprecated.  Multiplexed mode can handle
                 any situation that the other modes can handle.

                 By default the channels are established in multiplexed mode,
                 if the server is new enough to support it.  Multiplexed mode
                 uses a single TCP connection to implement the four channels.
                 A built-in packet layer multiplexes the different logical
                 channels on top of the TCP connection, in a manner not unlike
                 sssshh's port forwarding feature.  This adds a very small amount
                 of communication overhead (<1%) and a little bit of CPU over-
                 head, but it should work behind almost any kind of firewall
                 setup.  The firewall must permit the client host to initiate
                 connections to port 5999 of the server host; beyond that, no
                 special permissions are required.  To explicitly force multi-
                 plexed mode, use the option --PP mm.

                 Multiplexed mode can be used in conjunction with a SOCKS
                 proxy server.  Simply run ccvvssuupp under the rruunnssoocckkss command,
                 and add @@MM33nnoovvmm to the end of the ccvvssuupp command line.

                 Active mode implements the four unidirectional channels using
                 two bidirectional TCP connections.  The original connection
                 from the client to the server implements two channels, and a
                 second TCP connection implements the other two channels.  To
                 establish the second TCP connection, the server connects back
                 to the client.  With --PP _a, the client listens for the connec-
                 tion on a port chosen by the operating system.  Many operat-
                 ing systems use ports in the range 1024-5000 for this pur-
                 pose.  The user can specify a particular port with --PP _p_o_r_t,
                 or a range of ports with --PP _l_o_-_h_i.  These port specifications
                 cannot be used through a SOCKS proxy server.

                 Passive mode is similar in that it also uses two TCP connec-
                 tions to implement the four unidirectional channels.  How-
                 ever, in passive mode the client connects to the server to
                 create the second TCP connection.  Passive mode can be useful
                 when the client is behind a firewall that allows outbound
                 connections, but denies most incoming connections.  To select
                 passive mode, use the option --PP --.  Passive mode cannot be
                 used through a SOCKS proxy server.

     --rr _m_a_x_R_e_t_r_i_e_s
                 Limits the number of automatic retries that will be attempted
                 when transient errors such as lost network connections are
                 encountered.  By default, when the GUI is not used, ccvvssuupp
                 will retry indefinitely until an update is successfully com-
                 pleted.  The retries are spaced using randomized exponential
                 backoff.  Use of the GUI implies --rr 00.  Note that --rr 00 is
                 equivalent to the --11 option.

     --ss          Suppresses the check of each client file's status against
                 what is recorded in the list file.  Instead, the list file is
                 assumed to be accurate.  This option greatly reduces the
                 amount of disk activity and results in faster updates with
                 less load on the client host.  However it should only be used
                 if client's files are never modified locally in any way.
                 Mirror sites may find this option beneficial to reduce the
                 disk load on their systems.  For safety, even mirror sites
                 should run ccvvssuupp occasionally (perhaps once a day) without
                 the --ss option.

                 Without the --ss option, ccvvssuupp performs a stat(2) call on each
                 file and verifies that its attributes match those recorded in
                 the list file.  This ensures that any file changes made out-
                 side of CCVVSSuupp are detected and corrected.

                 If the --ss option is used when one or more files have been
                 modified locally, the results are undefined.  Local file dam-
                 age may remain uncorrected, updates may be missed, or ccvvssuupp
                 may abort prematurely.

     --vv          Prints the version number and exits, without contacting the
                 server.

     --zz          Enables compression for all collections, as if the ccoommpprreessss
                 keyword were added to every collection in the _s_u_p_f_i_l_e.

     --ZZ          Disables compression for all collections, as if the ccoommpprreessss
                 keyword were removed from every collection in the _s_u_p_f_i_l_e.

     The _s_u_p_f_i_l_e is a text file which specifies the file collections to be
     updated.  Comments begin with `#' and extend to the end of the line.
     Lines that are empty except for comments and white space are ignored.
     Each remaining line begins with the name of a server-defined collection
     of files.  Following the collection name on the line are zero or more
     keywords or keyword=value pairs.

     Default settings may be specified in lines whose collection name is
     **ddeeffaauulltt.  Such defaults will apply to subsequent lines in the _s_u_p_f_i_l_e.
     Multiple **ddeeffaauulltt lines may be present.  New values augment or override
     any defaults specified earlier in the _s_u_p_f_i_l_e.  Values specified explic-
     itly for a collection override any default values.

     The most commonly used keywords are:

     rreelleeaassee==_r_e_l_e_a_s_e_N_a_m_e
                 This specifies the release of the files within a collection.
                 Like collection names, release names are defined by the
                 server configuration files.  Usually there is only one
                 release in each collection, but there may be any number.
                 Collections which come from a CVS repository often use
                 rreelleeaassee==ccvvss by convention.  Non-CVS collections convention-
                 ally use rreelleeaassee==ccuurrrreenntt.

     bbaassee==_b_a_s_e   This specifies a directory under which ccvvssuupp will maintain
                 its bookkeeping files, describing the state of each collec-
                 tion on the client machine.  The _b_a_s_e directory must already
                 exist; ccvvssuupp will not create it.  The default _b_a_s_e directory
                 is _/_u_s_r_/_l_o_c_a_l_/_e_t_c_/_c_v_s_u_p.

     pprreeffiixx==_p_r_e_f_i_x
                 This is the directory under which updated files will be
                 placed.  By default, it is the same as _b_a_s_e.  If it is not an
                 absolute pathname, it is interpreted relative to _b_a_s_e.  The
                 _p_r_e_f_i_x directory must already exist; ccvvssuupp will not create
                 it.

                 As a special case, if _p_r_e_f_i_x is a symbolic link pointing to a
                 nonexistent file named `SKIP', then ccvvssuupp will skip the col-
                 lection.  The parameters associated with the collection are
                 still checked for validity, but none of its files will be
                 updated.  This feature allows a site to use a standard
                 _s_u_p_f_i_l_e on several machines, yet control which collections
                 get updated on a per-machine basis.

     hhoosstt==_h_o_s_t_n_a_m_e
                 This specifies the server machine from which all files will
                 be taken.  ccvvssuupp requires that all collections in a single
                 run come from the same host.  If you wish to update collec-
                 tions from several different hosts, you must run ccvvssuupp sev-
                 eral times.

     ddeelleettee      The presence of this keyword gives ccvvssuupp permission to delete
                 files.  If it is missing, no files will be deleted.

                 The presence of the ddeelleettee keyword puts ccvvssuupp into so-called
                 _e_x_a_c_t mode.  In exact mode, CCVVSSuupp does its best to make the
                 client's files correspond to those on the server.  This
                 includes deleting individual deltas and symbolic tags from
                 RCS files, as well as deleting entire files.  In exact mode,
                 CCVVSSuupp verifies every edited file with a checksum, to ensure
                 that the edits have produced a file identical to the master
                 copy on the server.  If the checksum test fails for a file,
                 then CCVVSSuupp falls back upon transferring the entire file.

                 In general, CCVVSSuupp deletes only files which are known to the
                 server.  Extra files present in the client's tree are left
                 alone, even in exact mode.  More precisely, CCVVSSuupp is willing
                 to delete two classes of files:
                 ··   Files that were previously created or updated by CCVVSSuupp
                     itself.
                 ··   Checked-out versions of files which are marked as dead on
                     the server.

     uussee--rreell--ssuuffffiixx
                 Causes ccvvssuupp to append a suffix constructed from the release
                 and tag to the name of each list file that it maintains.  See
                 _T_H_E _L_I_S_T _F_I_L_E for details.

     ccoommpprreessss    This enables compression of all data sent across the network.
                 Compression is quite effective, normally eliminating 65% to
                 75% of the bytes that would otherwise need to be transferred.
                 However, it is costly in terms of CPU time on both the client
                 and the server.  On local area networks, compression is gen-
                 erally counter-productive; it actually slows down file
                 updates.  On links with speeds of 56K bits/second or less,
                 compression is almost always beneficial.  For network links
                 with speeds between these two extremes, let experimentation
                 be your guide.

                 The --zz command line option enables the ccoommpprreessss keyword for
                 all collections, regardless of what is specified in the sup-
                 file.  Likewise, the --ZZ command line option disables the
                 ccoommpprreessss option for all collections.

     nnoorrccss       Disables special processing for RCS files.  They will be
                 treated the same as other files.

     nnoorrssyynncc     Disables the use of Tridgell & Mackerras' _r_s_y_n_c algorithm for
                 updating regular (non-RCS) files.  The algorithm works cor-
                 rectly for any kind of file, but it may be ineffective and
                 computationally expensive for files such as compressed tar
                 archives.

     ssttrriiccttrrccss   Causes updated RCS files to be checked using strict byte-by-
                 byte MD5 checksums.  Normally, CCVVSSuupp uses a looser checksum
                 for RCS files, which ignores harmless differences in white
                 space.  Different versions of CVS and RCS produce a variety
                 of differences in white space for the same RCS files.  Thus
                 the strict checksum can report spurious mismatches for files
                 which are logically identical.  This can lead to numerous
                 unneeded ``fixups'', and thus to slow updates.

     nnoocchheecckkrrccss  Disables the comparison of MD5 checksums for updated RCS
                 files.  This option is turned on automatically if the ddeelleettee
                 keyword is not specified.

     eexxeeccuuttee     Enables the execution of shell commands received from the
                 server.  This should be used with caution, since it may con-
                 stitute a security risk.

     pprreesseerrvvee    Causes ccvvssuupp to attempt to transfer all possible file
                 attributes from the server to the client.  The attributes
                 supported depend on both the host platform and the client
                 platform.  On FreeBSD systems, the following attributes are
                 supported:
                 ··   Owner.
                 ··   Group.
                 ··   Permissions.
                 ··   Flags.
                 ··   Modification time.

                 Of these, the first four are controlled by the pprreesseerrvvee key-
                 word, while the fifth is preserved in all cases.

                 The pprreesseerrvvee keyword is not intended to be used for updating
                 user files or CVS repositories.  It is intended only for spe-
                 cialized applications in which a host's entire file tree is
                 to be replicated exactly.  Any differences between the server
                 host and the client host can cause problems if pprreesseerrvvee is
                 specified.  For example, if the client receives a file whose
                 owner does not exist on the client machine, it will be unable
                 to preserve the owner.  This may in turn cause the permis-
                 sions to have unintended meanings.  In addition, each subse-
                 quent update run will cause further unsuccessful attempts to
                 correct the file's owner on the client, wasting time and
                 bandwidth.  Finally, pprreesseerrvvee mode increases the network
                 traffic and slows down updates.

                 For pprreesseerrvvee mode to function properly, the client must be
                 executed with root access permissions.  If the client is not
                 root, then attempts to preserve the owner, group, and flags
                 are suppressed.

                 The pprreesseerrvvee keyword is ignored in checkout mode.

     uummaasskk==_n     Causes ccvvssuupp to use a umask value of _n (an octal number) when
                 updating the files in the collection.  This option is ignored
                 if pprreesseerrvvee is specified.

     Some additional, more specialized keywords are described below.  Unrecog-
     nized keywords are silently ignored for backward compatibility with ssuupp.

OOPPEERRAATTIIOONN
     ccvvssuupp includes a graphical user interface (GUI) which allows one to moni-
     tor its progress and performance during an update.  The GUI is disabled
     if the --gg command line option is given, or if the DISPLAY environment
     variable is not set.  The GUI includes a ``Filter'' type-in field, where
     patterns may be entered to restrict the files to be updated.  The pat-
     terns are as described for the --ii option.  If multiple patterns are
     entered, they should be separated by white space.

     At present, the GUI does not support changing the parameters specified in
     the _s_u_p_f_i_l_e.  That is planned for a future release.  Despite its relative
     uselessness, the GUI is fun to watch.

CCVVSS MMOODDEE
     CCVVSSuupp supports two primary modes of operation.  They are called _C_V_S mode
     and _c_h_e_c_k_o_u_t mode.

     In CVS mode, the client receives copies of the actual RCS files making up
     the master CVS repository.  CVS mode is the default mode of operation.
     It is appropriate when the user wishes to maintain a full copy of the CVS
     repository on the client machine.

     CVS mode is also appropriate for file collections which are not based
     upon a CVS repository.  The files are simply transferred verbatim, with-
     out interpretation.

CCHHEECCKKOOUUTT MMOODDEE
     In checkout mode, the client receives specific revisions of files,
     checked out directly from the server's CVS repository.  Checkout mode
     allows the client to receive any version from the repository, without
     requiring any extra disk space on the server for storing multiple ver-
     sions in checked-out form.  Checkout mode provides much flexibility
     beyond that basic functionality, however.  The client can specify any CVS
     symbolic tag, or any date, or both, and CCVVSSuupp will provide the corre-
     sponding checked-out versions of the files in the repository.

     Checkout mode is selected on a per-collection basis, by the presence of
     one or both of the following keywords in the _s_u_p_f_i_l_e:

     ttaagg==_t_a_g_n_a_m_e
                 This specifies a symbolic tag that should be used to select
                 the revisions that are checked out from the CVS repository.
                 The tag may refer to either a branch or a specific revision.
                 It must be symbolic; numeric revision numbers are not sup-
                 ported.

                 For the FreeBSD source repository, the most commonly used
                 tags will be:

                 RELENG_3  The `stable' branch.

                 .         The main branch (the `current' release).  This is
                           the default, if only the ddaattee keyword is given.

     ddaattee==[_c_c]_y_y_._m_m_._d_d_._h_h_._m_m_._s_s
                 This specifies a date that should be used to select the revi-
                 sions that are checked out from the CVS repository.  The
                 client will receive the revisions that were in effect at the
                 specified date and time.

                 At present, the date format is inflexible.  All 17 or 19
                 characters must be specified, exactly as shown.  For the
                 years 2000 and beyond, specify the century _c_c.  For earlier
                 years, specify only the last two digits _y_y.  Dates and times
                 are considered to be GMT.  The default date is `.', which
                 means ``as late as possible''.

     To enable checkout mode, you must specify at least one of these keywords.
     If both are missing, CCVVSSuupp defaults to CVS mode.

     If both a branch tag and a date are specified, then the revisions on the
     given branch, as of the given date, will be checked out.  It is permit-
     ted, but not particularly useful, to specify a date with a specific
     release tag.

     In checkout mode, the tag and/or date may be changed between updates.
     For example, suppose that a collection has been transferred using the
     specification `tag=.'.  The user could later change the specification to
     `tag=RELENG_3'.  This would cause CCVVSSuupp to edit the checked-out files in
     such a way as to transform them from the `current' versions to the
     `stable' versions.  In general, CCVVSSuupp is willing to transform any
     tag/date combination into any other tag/date combination, by applying the
     intervening RCS deltas to the existing files.

     When transforming a collection of checked-out files from one tag to
     another, it is important to specify the lliisstt keyword in the _s_u_p_f_i_l_e, to
     ensure that the same list file is used both before and after the trans-
     formation.  The list file is described in _T_H_E _L_I_S_T _F_I_L_E, below.

TTHHEE LLIISSTT FFIILLEE
     For efficiency, ccvvssuupp maintains a bookkeeping file for each collection,
     called the list file.  The list file contains information about which
     files and revisions the client currently possesses.  It also contains
     information used for verifying that the list file is consistent with the
     actual files in the client's tree.

     The list file is not strictly necessary.  If it is deleted, or becomes
     inconsistent with the actual client files, ccvvssuupp falls back upon a less
     efficient method of identifying the client's files and performing its
     updates.  Depending on CCVVSSuupp's mode of operation, the fallback method
     employs time stamps, checksums, or analysis of RCS files.

     Because the list file is not essential, ccvvssuupp is able to ``adopt'' an
     existing file tree acquired by FTP or from a CD-ROM.  ccvvssuupp identifies
     the client's versions of the files, updates them as necessary, and cre-
     ates a list file for future use.  Adopting a foreign file tree is not as
     fast as performing a normal update.  It also produces a heavier load on
     the server.

     The list file is stored in a collection-specific directory; see _F_I_L_E_S for
     details.  Its name always begins with `checkouts'.  If the keyword
     uussee--rreell--ssuuffffiixx is specified in the _s_u_p_f_i_l_e, a suffix, formed from the
     release and tag, is appended to the name.  The default suffix can be
     overridden by specifying an explicit suffix in the _s_u_p_f_i_l_e:

     lliisstt==_s_u_f_f_i_x
                 This specifies a suffix for the name of the list file.  A
                 leading dot is provided automatically.  For example,
                 `list=stable' would produce a list file named
                 _c_h_e_c_k_o_u_t_s_._s_t_a_b_l_e, regardless of the release, tag, or
                 uussee--rreell--ssuuffffiixx keyword.

RREEFFUUSSEE FFIILLEESS
     The user can specify sets of files that he does not wish to receive.  The
     files are specified as file name patterns in so-called _r_e_f_u_s_e files.  The
     patterns are separated by whitespace, and multiple patterns are permitted
     on each line.  Files and directories matching the patterns are neither
     updated nor deleted; they are simply ignored.

     There is currently no provision for comments in refuse files.

     The patterns are similar to those of sh(1), except that there is no spe-
     cial treatment for slashes or for filenames that begin with a period.
     For example, the pattern `*.c' will match any file name ending with `.c'
     including those in subdirectories, such as `foo/bar/lam.c'.  All patterns
     are interpreted relative to the collection's prefix directory.

     If the files are coming from a CVS repository, as is usually the case,
     then they will be RCS files. These have a `,v' suffix which must be taken
     into account in the patterns. For example, the FreeBSD documentation
     files are in a sub-directory of _b_a_s_e called `doc'.  If `Makefile' from
     that directory is not required then the line

           _d_o_c_/_M_a_k_e_f_i_l_e

     will not work because the file on the server is called `Makefile,v.' A
     better solution would be

           _d_o_c_/_M_a_k_e_f_i_l_e_*

     which will match whether `Makefile' is an RCS file or not.

     As another example, to receive the FreeBSD documentation files without
     the Japanese, Russian, and Chinese translations, create a refuse file
     containing the following lines:

           _d_o_c_/_j_a_*
           _d_o_c_/_r_u_*
           _d_o_c_/_z_h_*

     As many as three refuse files are examined for each _s_u_p_f_i_l_e line.  There
     can be a global refuse file named _b_a_s_e_/_c_o_l_l_D_i_r_/_r_e_f_u_s_e which applies to
     all collections and releases.  There can be a per-collection refuse file
     named _b_a_s_e_/_c_o_l_l_D_i_r_/_c_o_l_l_e_c_t_i_o_n_/_r_e_f_u_s_e which applies to a specific collec-
     tion.  Finally, there can be a per-release and tag refuse file which
     applies only to a given release/tag combination within a collection.  The
     name of the latter is formed by suffixing the name of the per-collection
     refuse file in the same manner as described above for the list file.
     None of the refuse files are required to exist.

     ccvvssuupp has a built-in default value of _/_u_s_r_/_l_o_c_a_l_/_e_t_c_/_c_v_s_u_p for _b_a_s_e and
     _s_u_p for _c_o_l_l_D_i_r but it is possible to override both of these. The value
     of _b_a_s_e can be changed using the --bb option or a _b_a_s_e_=_p_a_t_h_n_a_m_e entry in
     the _s_u_p_f_i_l_e.  (If both are used the --bb option will override the _s_u_p_f_i_l_e
     entry.)  The value of _c_o_l_l_D_i_r can only be changed with the --cc option;
     there is no _s_u_p_f_i_l_e command to change it.

     As an example, suppose that the _b_a_s_e and _c_o_l_l_D_i_r both have their default
     values, and that the collection and release are `src-all' and `cvs',
     respectively.  Assume further that checkout mode is being used with
     `tag=RELENG_3'.  The three possible refuse files would then be named:

           _/_u_s_r_/_l_o_c_a_l_/_e_t_c_/_c_v_s_u_p_/_s_u_p_/_r_e_f_u_s_e
           _/_u_s_r_/_l_o_c_a_l_/_e_t_c_/_c_v_s_u_p_/_s_u_p_/_s_r_c_-_a_l_l_/_r_e_f_u_s_e
           _/_u_s_r_/_l_o_c_a_l_/_e_t_c_/_c_v_s_u_p_/_s_u_p_/_s_r_c_-_a_l_l_/_r_e_f_u_s_e_._c_v_s_:_R_E_L_E_N_G___3

     If the _s_u_p_f_i_l_e includes the command _b_a_s_e_=_/_f_o_o the refuse files would be:

           _/_f_o_o_/_s_u_p_/_r_e_f_u_s_e
           _/_f_o_o_/_s_u_p_/_s_r_c_-_a_l_l_/_r_e_f_u_s_e
           _/_f_o_o_/_s_u_p_/_s_r_c_-_a_l_l_/_r_e_f_u_s_e_._c_v_s_:_R_E_L_E_N_G___3

     If --bb _/_b_a_r is used (even with _b_a_s_e_=_/_f_o_o in the _s_u_p_f_i_l_e):

           _/_b_a_r_/_s_u_p_/_r_e_f_u_s_e
           _/_b_a_r_/_s_u_p_/_s_r_c_-_a_l_l_/_r_e_f_u_s_e
           _/_b_a_r_/_s_u_p_/_s_r_c_-_a_l_l_/_r_e_f_u_s_e_._c_v_s_:_R_E_L_E_N_G___3

     and with --cc _s_t_o_o_l as well:

           _/_b_a_r_/_s_t_o_o_l_/_r_e_f_u_s_e
           _/_b_a_r_/_s_t_o_o_l_/_s_r_c_-_a_l_l_/_r_e_f_u_s_e
           _/_b_a_r_/_s_t_o_o_l_/_s_r_c_-_a_l_l_/_r_e_f_u_s_e_._c_v_s_:_R_E_L_E_N_G___3

AAUUTTHHEENNTTIICCAATTIIOONN
     CCVVSSuupp implements an optional authentication mechanism which can be used
     by the client and server to verify each other's identities.  Public CVSup
     servers normally do not enable authentication.  CVSup users may ignore
     this section unless they have been informed that authentication is
     required by the administrator of their server.

     The authentication subsystem uses a challenge-response protocol which is
     immune to packet sniffing and replay attacks.  No passwords are sent over
     the network in either direction.  Both the client and the server can
     independently verify the identities of each other.

     The file $HOME_/_._c_v_s_u_p_/_a_u_t_h holds the information used for authentication.
     This file contains a record for each server that the client is allowed to
     access.  Each record occupies one line in the file.  Lines beginning with
     `#' are ignored, as are lines containing only white space.  White space
     is significant everywhere else in the file.  Fields are separated by `:'
     characters.

     Each record of the file has the following form:

           _s_e_r_v_e_r_N_a_m_e:_c_l_i_e_n_t_N_a_m_e:_p_a_s_s_w_o_r_d:_c_o_m_m_e_n_t

     All fields must be present even if some of them are empty.  _S_e_r_v_e_r_N_a_m_e is
     the name of the server to which the record applies.  By convention, it is
     the canonical fully-qualified domain name of the server, e.g.,
     `CVSup177.FreeBSD.ORG'.  This must agree with the server's own idea of
     its name.  The name is case-insensitive.

     _C_l_i_e_n_t_N_a_m_e is the name the client uses to gain access to the server.  By
     convention, e-mail addresses are used for all client names, e.g.,
     `BillyJoe@FreeBSD.ORG'.  Client names are case-insensitive.

     _P_a_s_s_w_o_r_d is a secret string of characters that the client uses to prove
     its identity.  It may not contain any `:' or newline characters.

     _C_o_m_m_e_n_t may contain any additional information to identify the record.
     It is not interpreted by the program.

     To set up authentication for a given server, one must perform the follow-
     ing steps:

     1.   Obtain the official _s_e_r_v_e_r_N_a_m_e from the administrator of the server
          or from some other source.

     2.   Choose an appropriate _c_l_i_e_n_t_N_a_m_e.  It should be in the form of a
          valid e-mail address, to make it easy for the server administrator
          to contact the user if necessary.

     3.   Choose an arbitrary secret _p_a_s_s_w_o_r_d.

     4.   Run the ccvvppaasssswwdd utility, and type in the _p_a_s_s_w_o_r_d when prompted for
          it.  The utility will print out a line to send to the server admin-
          istrator, and instruct you how to modify your $HOME_/_._c_v_s_u_p_/_a_u_t_h
          file.  You should use a secure channel to send the line to the
          server administrator.

     Since $HOME_/_._c_v_s_u_p_/_a_u_t_h contains passwords, you should ensure that it is
     not readable by anyone except yourself.

     Authentication works independently in both directions.  The server admin-
     istrator controls whether you must prove your identity.  You control
     whether to check the server's identity, by means of the --aa command line
     option.

UUSSIINNGG CCVVSSuupp FFOORR MMIIRRRROORRIINNGG
     Although CCVVSSuupp is optimized for CVS repositories, it works quite well as
     a general purpose mirroring tool.  It is able to update all types of
     files.
     ··   RCS files are updated by transferring individual tags and deltas, and
         merging them into the client file.
     ··   Regular files are updated using the rsync algorithm, if it is
         enabled.  If the rsync algorithm is disabled, files which have had
         data appended to them on the server (e.g., log files) receive only
         the new tail portion.  Other regular files are replaced in whole.
     ··   Empty directories are preserved.
     ··   Symbolic links are updated as dictated by ssyymmlliinnkk and rrssyymmlliinnkk com-
         mands in the server's configuration files.  See cvsupd(8).
     ··   Hard links are preserved within each collection, but not between col-
         lections.
     ··   Device nodes are updated by major and minor device number.  This may
         not produce the desired results if the client host and the server
         host run different operating systems.

CCVVSSuupp AANNDD FFIIRREEWWAALLLLSS
     In its default mode, ccvvssuupp will work through any firewall which permits
     outbound connections to port 5999 of the server host.  With slightly more
     permissive firewall rules it may be possible to use passive mode or one
     of the other modes, for a very slight gain in efficiency.  See the
     description of the --PP option for details.

     For more information on using CVSup with specific kinds of firewalls, see
     the CVSup FAQ at <http://www.cvsup.org/>.

UUSSIINNGG CCVVSSuupp WWIITTHH SSOOCCKKSS
     CVSup can be used through a SOCKS proxy server with the standard rruunnssoocckkss
     command.  Your ccvvssuupp executable needs to be dynamically-linked with the
     system libraries for rruunnssoocckkss to work properly.  Also, when using
     rruunnssoocckkss you must add the magic parameter @@MM33nnoovvmm to the end of the ccvvssuupp
     command line.

UUSSIINNGG sssshh PPOORRTT FFOORRWWAARRDDIINNGG
     As an alternative to SOCKS, a user behind a firewall can penetrate it
     with the TCP port forwarding provided by the Secure Shell package sssshh.
     The user must have a login account on the CCVVSSuupp server host in order to
     do this.  The procedure is as follows:

     1.   Establish a connection to the server host with sssshh, like this:

          ssh -f -x -L 5999:localhost:5999 serverhost sleep 60

          Replace _s_e_r_v_e_r_h_o_s_t with the hostname of the CVSup server, but type
          `localhost' literally.  This sets up the required port forwarding.
          You must start ccvvssuupp before the 60-second sslleeeepp finishes.  Once the
          update has begun, sssshh will keep the forwarded channels open as long
          as they are needed.

     2.   Run ccvvssuupp on the local host, including the arguments `-h localhost'
          on the command line.

FFIILLEESS
     /usr/local/etc/cvsup              Default _b_a_s_e directory.
     sup                               Default _c_o_l_l_D_i_r subdirectory.
     _b_a_s_e_/_c_o_l_l_D_i_r_/_c_o_l_l_e_c_t_i_o_n/checkouts*
                                       List files.
     _b_a_s_e_/_c_o_l_l_D_i_r/refuse               Global refuse file.
     _b_a_s_e_/_c_o_l_l_D_i_r_/_c_o_l_l_e_c_t_i_o_n/refuse*   Per-collection and per-release and tag
                                       refuse files.
     $HOME/.cvsup/auth                 Authentication password file.

SSEEEE AALLSSOO
     cvpasswd(1), cvs(1), cvsupd(8), rcsintro(1), ssh(1).

     http://www.cvsup.org/

AAUUTTHHOORRSS
     John Polstra <jdp@polstra.com>.

LLEEGGAALLIITTIIEESS
     CVSup is a registered trademark of John D. Polstra.

BBUUGGSS
     An RCS file is not recognized as such unless its name ends with `,v'.

     Any directory named `Attic' is assumed to be a CVS Attic, and is treated
     specially.

     The GUI interacts poorly with some window managers, notably older ver-
     sions of FVWM.  Adding the line

           Style "cvsup" ClickToFocus

     to FVWM2's _._f_v_w_m_r_c file helps quite a bit.  The problem appears to be
     caused by window manager bugs, triggered by the GUI's use of the
     `WM_TAKE_FOCUS' protocol.  As a work-around, you can always use the --gg
     option to disable the GUI entirely.

FreeBSD                         January 1, 2002                        FreeBSD
